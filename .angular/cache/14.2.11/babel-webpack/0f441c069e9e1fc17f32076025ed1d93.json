{"ast":null,"code":"import { FilterProjectAssigned } from '../../model/project/filterproject';\nimport { FormControl } from '@angular/forms';\nimport { lastValueFrom, map, startWith } from 'rxjs';\nimport { User } from '../../model/user/user';\nimport Swal from 'sweetalert2';\nimport { ProjectStep2, ProjectStep5 } from '../../model/project/project';\nimport { Chart } from 'chart.js/auto';\nimport 'chartjs-plugin-datalabels';\nimport * as jsPDF from 'jspdf';\nimport html2canvas from 'html2canvas';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/common/mastertable.service\";\nimport * as i2 from \"ngx-spinner\";\nimport * as i3 from \"../../services/project/projecttype.service\";\nimport * as i4 from \"../../services/project/project.service\";\nimport * as i5 from \"../../services/person/person.service\";\nimport * as i6 from \"@angular/router\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"@angular/forms\";\nimport * as i9 from \"@angular/material/autocomplete\";\nimport * as i10 from \"@angular/material/core\";\nimport * as i11 from \"@angular/material/form-field\";\nimport * as i12 from \"@angular/material/input\";\n\nfunction ReporteExportablePdfComponent_mat_option_36_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 60);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const option_r13 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", option_r13.scodproject);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", option_r13.scodproject, \" \");\n  }\n}\n\nfunction ReporteExportablePdfComponent_mat_option_45_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 60);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const option_r14 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", option_r14.snameproject);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", option_r14.snameproject, \" \");\n  }\n}\n\nfunction ReporteExportablePdfComponent_option_53_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 61);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const item_r15 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", item_r15.nid_mastertable_type);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", item_r15.sshort_value, \"\");\n  }\n}\n\nfunction ReporteExportablePdfComponent_th_73_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 62);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementStart(2, \"span\");\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"date\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const i_r17 = ctx.index;\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" S\", i_r17 + 1, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Fecha Inicio: \", i0.ɵɵpipeBind2(4, 2, ctx_r5.listSemanasStart[i_r17], \"dd/MM/yyyy\"), \"\");\n  }\n}\n\nfunction ReporteExportablePdfComponent_th_80_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 46);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const i_r19 = ctx.index;\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r6.listCostoPlanificado[i_r19], \" \");\n  }\n}\n\nfunction ReporteExportablePdfComponent_th_86_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 46);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const i_r21 = ctx.index;\n    const ctx_r7 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r7.listCostoReal[i_r21], \" \");\n  }\n}\n\nfunction ReporteExportablePdfComponent_th_90_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 46);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const e_r23 = ctx.index;\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r8.indicadorSemaforoNumber(e_r23), \" \");\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    \"background-color\": a0\n  };\n};\n\nfunction ReporteExportablePdfComponent_th_94_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\")(1, \"div\", 63);\n    i0.ɵɵelement(2, \"div\", 64);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const e_r25 = ctx.index;\n    const ctx_r9 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(1, _c0, ctx_r9.indicadorSemaforo(e_r25)));\n  }\n}\n\nfunction ReporteExportablePdfComponent_th_104_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 62);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementStart(2, \"span\");\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"date\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const i_r27 = ctx.index;\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" S\", i_r27 + 1, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Fecha Inicio: \", i0.ɵɵpipeBind2(4, 2, ctx_r10.listSemanasStart[i_r27], \"dd/MM/yyyy\"), \"\");\n  }\n}\n\nfunction ReporteExportablePdfComponent_tr_109_td_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 51);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const item_r31 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", item_r31.nhours_asigned, \" \");\n  }\n}\n\nfunction ReporteExportablePdfComponent_tr_109_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 51);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, ReporteExportablePdfComponent_tr_109_td_3_Template, 2, 1, \"td\", 65);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const item_r28 = ctx.$implicit;\n    const ctx_r11 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\" \", item_r28.sperson, \" ( \", item_r28.srol, \" ) \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r11.FilterPersonWeek(item_r28.nid_person));\n  }\n}\n\nfunction ReporteExportablePdfComponent_tr_112_td_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 51);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const item2_r36 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", item2_r36, \" \");\n  }\n}\n\nfunction ReporteExportablePdfComponent_tr_112_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 51);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, ReporteExportablePdfComponent_tr_112_td_3_Template, 2, 1, \"td\", 65);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const item_r33 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", item_r33[2], \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", item_r33[1]);\n  }\n}\n\nexport class ReporteExportablePdfComponent {\n  constructor(mastertableService, spinner, projectTypeService, projectService, servicePerson) {\n    this.mastertableService = mastertableService;\n    this.spinner = spinner;\n    this.projectTypeService = projectTypeService;\n    this.projectService = projectService;\n    this.servicePerson = servicePerson;\n    this.BreadLevel01 = 'Reportes';\n    this.Title = 'Reporte exportable en PDF';\n    this.filterProject = new FilterProjectAssigned();\n    this.projectList = [];\n    this.listProjectFilter = [];\n    this.listState = [];\n    this.myControl = new FormControl();\n    this.myControll = new FormControl();\n    this.inputNombreServicio = \"\";\n    this.permisoAdministrador = true;\n    this.user = new User();\n    this.currentPage = 1;\n    this.itemsPerPage = 999;\n    this.totalItems = 0; // Operación\n\n    this.scodproject = \"\";\n    this.projectStep5 = new ProjectStep5();\n    this.listInvoicing = [];\n    this.ingresosReales = 0;\n    this.costoReal = 0;\n    this.costoReal1 = 0;\n    this.listCost = [];\n    this.listprogress = [];\n    this.listAvanceProyecto = [];\n    this.listInvestment = [];\n    this.projectStep2 = new ProjectStep2();\n    this.ListWeekProgressn = [];\n    this.ListWeekPerson = [];\n    this.ncantidadsemanas = 0;\n    this.arrayNumberWeek = [];\n    this.listProjectHoursLog = [];\n    this.listSemanasStart = [];\n    this.listSemanasFinish = [];\n    this.listhoras = [];\n    this.listCostoPlanificado = [];\n    this.listCostoReal = [];\n    this.listProjectEstimate = [];\n    this.cantidad_columnas = 2;\n    this.facturacion_montoesperado = [];\n    this.facturacion_montofacturado = [];\n    this.facturacion_montoreal = [];\n    this.facturacion_labels = [];\n    this.let_mes = new Map([[0, \"Enero\"], [1, \"Febrero\"], [2, \"Marzo\"], [3, \"Abril\"], [4, \"Mayo\"], [5, \"Junio\"], [6, \"Julio\"], [7, \"Agosto\"], [8, \"Septiembre\"], [9, \"Octubre\"], [10, \"Noviembre\"], [11, \"Diciembre\"]]);\n    this.mesesLabel = [];\n    this.date1String = \"\";\n    this.date2String = \"\";\n    this.dateMax = \"\";\n    this.dateMin = \"\";\n    this.simbMoneda = \"\";\n    this.listProjectHoursExt = [];\n    this.showData = false;\n    this.cumplimiento_tareasATiempo = 0;\n    this.cumplimiento_tareasFueraDeTiempo = 0;\n    this.cumplimiento_tareasTerminadas = 0;\n    this.cumplimiento_avanceDelProyecto = 0;\n    this.cumplimiento_totalTareas = 0;\n    this.filterProject.pagination.ItemsPerPage = this.itemsPerPage;\n    this.filterProject.pagination.TotalItems = this.totalItems;\n    this.filterProject.pagination.CurrentPage = this.currentPage;\n  }\n\n  ngOnInit() {\n    this.showData = false;\n    this.RenderChart();\n\n    if (sessionStorage.getItem('Guard') !== null) {\n      this.user = JSON.parse(sessionStorage.getItem('User'));\n    }\n\n    this.getState();\n    this.getProjectTypeDropDown();\n    this.getProyectos();\n    this.codigoProyecto = this.myControl.valueChanges.pipe(startWith(''), map(val => this.filter(val)));\n    this.nombreProyecto = this.myControll.valueChanges.pipe(startWith(''), map(val => this.filter2(val)));\n  }\n\n  filter(val) {\n    return this.listProjectFilter.filter(project => project.scodproject.toLowerCase().indexOf(val.toLowerCase()) === 0);\n  }\n\n  filter2(val) {\n    return this.listProjectFilter.filter(project => project.snameproject.toLowerCase().indexOf(val.toLowerCase()) === 0);\n  }\n\n  changeNombreServicio() {\n    let proyecto = this.projectList.find(project => project.snameproject == this.inputNombreServicio);\n\n    if (proyecto !== null && proyecto !== undefined) {\n      this.filterProject.scodproject = proyecto.scodproject;\n    }\n  }\n\n  changeCodigoServicio() {\n    console.log(this.filterProject.scodproject);\n    let proyecto = this.projectList.find(project => project.scodproject == this.filterProject.scodproject);\n\n    if (proyecto !== null && proyecto !== undefined) {\n      this.inputNombreServicio = proyecto.snameproject;\n    }\n  }\n\n  changeEstado() {\n    if (this.filterProject.nid_status == 0) {\n      this.listProjectFilter = this.projectList;\n    } else {\n      let cadena = this.listState.find(stado => stado.nid_mastertable_type == this.filterProject.nid_status).sshort_value.toUpperCase();\n      this.listProjectFilter = this.projectList.filter(proyecto => proyecto.sstatusname.toUpperCase() == cadena);\n    }\n\n    this.myControl.setValue(\"\");\n    this.myControll.setValue(\"\");\n  }\n\n  fisrtChange() {\n    this.myControl.setValue(\"\");\n    this.myControll.setValue(\"\");\n  }\n\n  getState() {\n    this.spinner.show('SpinnerProject'); //let idFather=this.listCategory.find(x=>x.nid_mastertable_type==id).nid_mastertable;\n\n    this.mastertableService.getmastertable(50).subscribe(response => {\n      this.listState = response;\n      this.listState = this.listState.filter(x => x.sshort_value == \"ACTIVO\" || x.sshort_value == \"CERRADO\");\n      this.spinner.hide('SpinnerProject');\n    }, error => {\n      console.error(error);\n      this.spinner.hide('SpinnerProject');\n    });\n  }\n\n  getProjectTypeDropDown() {\n    this.spinner.show('SpinnerProject');\n    this.projectTypeService.getDropdownlist().subscribe(response => {\n      if (response == null) {\n        this.filterProject.nid_project_type = 0;\n        return;\n      }\n\n      this.ProjectTypeDropDownList = response;\n\n      if (this.ProjectTypeDropDownList.length > 0) {\n        this.filterProject.nid_project_type = 0;\n      }\n\n      this.spinner.hide('SpinnerProject');\n    }, error => {\n      console.error(error);\n      this.spinner.hide('SpinnerProject');\n    });\n  }\n\n  getProyectos() {\n    this.filterProject.nid_manager = 0;\n    this.filterProject.nid_status = 0;\n\n    if (this.permisoAdministrador) {\n      this.filterProject.nid_manager = 0;\n      this.filterProject.nid_person = 0;\n    } else {\n      this.filterProject.nid_manager = 0;\n      this.filterProject.nid_person = this.user.nid_person;\n    }\n\n    this.spinner.show();\n    this.projectService.getassignedprojectpagination(this.filterProject).subscribe(res => {\n      try {\n        if (res == null) {\n          Swal.fire({\n            icon: 'error',\n            title: 'Ocurrió un error al obtener los registros.' //text: 'Por favor, escríbenos a la siguiente dirección: ' +'comercial@crecerseguros.pe. Nuestro ejecutivo comercial se contactará contigo'\n\n          });\n        }\n\n        this.spinner.hide();\n        this.projectList = res.data;\n        this.listProjectFilter = res.data;\n        this.fisrtChange();\n        this.totalItems = res.pagination.totalItems;\n      } catch (e) {\n        this.spinner.hide();\n        this.projectList = null;\n        this.totalItems = 0;\n      }\n    });\n  }\n\n  search() {\n    this.showData = true;\n    this.scodproject = this.filterProject.scodproject;\n    this.esperarRespuesta();\n  }\n\n  esperarRespuesta() {\n    var projectStep3 = lastValueFrom(this.projectService.getprojectdtep3(this.scodproject));\n    var projectStep2 = lastValueFrom(this.projectService.getprojectdtep2(this.scodproject));\n    var projectStep5 = lastValueFrom(this.projectService.getprojectdtep5(this.scodproject)); // Devuelve la facturacion\n\n    var facturacionProyecto = lastValueFrom(this.projectService.getprojectinvoicing(this.scodproject)); // Devuelve el costo para cada integrante del proyecto  \n\n    var costoIntegrantes = lastValueFrom(this.servicePerson.getPersonCostByScodproject(this.scodproject)); // Esto devuelve las horas estimadas\n\n    var horasEstimadas = lastValueFrom(this.projectService.getprojectweekperson(this.scodproject)); // La lista de personal estimado\n\n    var personalEstimado = lastValueFrom(this.projectService.getprojectestimate(this.scodproject, 2)); // Devuelve las horas registradas para el proyecto\n\n    var horasRegistradas = lastValueFrom(this.projectService.getprojecthourslog(this.scodproject)); // Devuelve los registros\n\n    var registrosAvanceProject = lastValueFrom(this.projectService.getprojectprogress(this.scodproject)); // Obtener horas registradas de personal externo y proveedores\n\n    var horasRegistradasExt = lastValueFrom(this.projectService.getprojecthoursext(this.scodproject));\n    this.spinner.show('SpinnerProject');\n    Promise.all([projectStep3, projectStep2, costoIntegrantes, horasEstimadas, personalEstimado, horasRegistradas, projectStep5, facturacionProyecto, registrosAvanceProject, horasRegistradasExt]).then(value => {\n      this.spinner.hide('SpinnerProject'); // Step 3, obtiene la lista de estimados, con su costo estimado por rol\n\n      this.listInvestment = value[0].listInvestment; // Step 2\n\n      this.projectStep2 = value[1];\n\n      if (this.projectStep2.ncurrency == 1) {\n        this.simbMoneda = \"S/.\";\n      } else {\n        this.simbMoneda = \"$\";\n      }\n\n      this.date1String = this.projectStep2.dbegin_date.substring(0, 7);\n      this.dateMin = this.projectStep2.dbegin_date.substring(0, 7);\n      this.date2String = this.projectStep2.dfinish_date.substring(0, 7);\n      this.dateMax = this.projectStep2.dfinish_date.substring(0, 7);\n      this.ncantidadsemanas = this.projectStep2.nweeks;\n      this.arrayNumberWeek = new Array(this.ncantidadsemanas);\n      this.generateArregloSemanas(); // Costo Real Integrantes del proyecto\n\n      this.listCost = value[2];\n\n      if (this.listCost === null || this.listCost === undefined) {\n        this.mensajeError(\"Debe asignar personal al proyecto\");\n        return;\n      }\n\n      console.log(\"La lista de costos\", this.listCost);\n      this.listCost.forEach(element => {\n        element.dcost_date = new Date(element.dcost_date);\n      }); // Horas estimadas\n\n      this.ListWeekPerson = value[3]; // Personal\n\n      this.listProjectPersonal = value[4]; // Personal estimado no auxiliar\n\n      this.listProjectEstimate = value[4].filter(x => x.isAuxiliary == false); // Personal Auxiliar\n\n      this.listProjectEstimateAuxiliary = value[4].filter(ls => ls.isAuxiliary == true); // Horas Registradas\n\n      this.calculateCostoPlanificado();\n\n      if (value[5] === null || value[5] === undefined) {\n        this.mensajeError(\"No existen horas registradas en el proyecto\");\n        return;\n      }\n\n      this.listProjectHoursLog = value[5].filter(x => x.sstate == \"A\"); // Step 5\n\n      this.projectStep5 = value[6];\n      console.log(this.projectStep5); // Facturacion del proyecto\n\n      this.listInvoicing = value[7];\n      this.calculoFacturacion(); // Obtener ultimo registro de avance\n\n      this.listprogress = value[8];\n\n      if (this.listprogress != null && this.listprogress.length >= 1) {\n        this.listAvanceProyecto = this.listprogress[0].listProgressDetail;\n        this.llenarGrafico2();\n      } else {\n        this.listAvanceProyecto = [];\n      }\n\n      if (value[9] != null) {\n        this.listProjectHoursExt = value[9].filter(x => x.sstate == \"A\");\n        console.log(this.listProjectHoursExt);\n      } else {\n        this.listProjectHoursExt = [];\n      }\n\n      this.calculo();\n      this.calcularCostoReal();\n      this.llenarNuevoGrafico();\n    });\n  }\n\n  calculoFacturacion() {\n    let esperado = [];\n    let real = [];\n    let facturado = [];\n    this.facturacion_montoesperado = [];\n    this.facturacion_montofacturado = [];\n    this.facturacion_montoreal = [];\n    this.facturacion_labels = [];\n\n    if (this.listInvoicing != null) {\n      this.ingresosReales = 0;\n      this.listInvoicing.forEach(invo => {\n        let date_esperado = new Date(invo.dplanned_date);\n        date_esperado.setDate(date_esperado.getDate() + 1);\n        date_esperado.setHours(0, 0, 0, 0);\n        esperado.push([date_esperado, 1, invo.namount]);\n\n        if (invo.binvoiced) {\n          let date_facturado = new Date(invo.dbilling_date);\n          date_facturado.setDate(date_facturado.getDate() + 1);\n          date_facturado.setHours(0, 0, 0, 0);\n          facturado.push([date_facturado, 2, invo.namount]);\n        }\n\n        if (invo.bpaid) {\n          this.ingresosReales += Number(invo.namount);\n          let date_real = new Date(invo.dinvoice_payment_date);\n          date_real.setDate(date_real.getDate() + 1);\n          date_real.setHours(0, 0, 0, 0);\n          real.push([date_real, 3, invo.namount]);\n        }\n      });\n      let allDates = [...esperado, ...real, ...facturado];\n      allDates.sort((a, b) => a[0].getTime() - b[0].getTime());\n      let fechasUnicas = [];\n      let fechaAnterior = '';\n\n      for (let fecha of allDates) {\n        let fechaString = this.convertDatetoString(fecha[0]);\n\n        if (fechaString !== fechaAnterior) {\n          fechasUnicas.push(fechaString);\n          fechaAnterior = fechaString;\n        }\n      }\n\n      let montoEsperado = [];\n      let montoFacturado = [];\n      let montoReal = [];\n\n      for (let fecha of fechasUnicas) {\n        montoEsperado.push([fecha, 0]);\n        montoFacturado.push([fecha, 0]);\n        montoReal.push([fecha, 0]);\n      }\n\n      for (let fecha of allDates) {\n        let fechaString = this.convertDatetoString(fecha[0]);\n        let encontrado;\n\n        if (fecha[1] == 1) {\n          encontrado = montoEsperado.find(x => x[0] == fechaString);\n          encontrado[1] += fecha[2];\n        }\n\n        if (fecha[1] == 2) {\n          encontrado = montoFacturado.find(x => x[0] == fechaString);\n          encontrado[1] += fecha[2];\n        }\n\n        if (fecha[1] == 3) {\n          encontrado = montoReal.find(x => x[0] == fechaString);\n          encontrado[1] += fecha[2];\n        }\n      } // Esto es solo por decoracion\n\n\n      let suma_valor1 = 0;\n\n      for (let i = 0; i < montoEsperado.length; i++) {\n        suma_valor1 += montoEsperado[i][1];\n        montoEsperado[i][1] = suma_valor1;\n      }\n\n      let suma_valor2 = 0;\n\n      for (let i = 0; i < montoFacturado.length; i++) {\n        suma_valor2 += montoFacturado[i][1];\n        montoFacturado[i][1] = suma_valor2;\n      }\n\n      let suma_valor3 = 0;\n\n      for (let i = 0; i < montoReal.length; i++) {\n        suma_valor3 += montoReal[i][1];\n        montoReal[i][1] = suma_valor3;\n      }\n\n      this.facturacion_montoesperado = montoEsperado;\n      this.facturacion_montofacturado = montoFacturado;\n      this.facturacion_montoreal = montoReal;\n      this.facturacion_labels = fechasUnicas;\n      this.llenarGrafico3();\n    } else {\n      this.listInvoicing = [];\n      this.ingresosReales = 0;\n    }\n  }\n\n  convertDatetoString(fecha) {\n    return fecha.getDate().toString().padStart(2, '0') + '/' + (fecha.getMonth() + 1).toString().padStart(2, '0') + \"/\" + fecha.getFullYear();\n  }\n\n  generateArregloSemanas() {\n    // Limpiar datos\n    this.listSemanasStart = [];\n    this.listSemanasFinish = [];\n    let fechaIni;\n    let fechaFin;\n    fechaIni = new Date(this.projectStep2.dbegin_date);\n    fechaIni.setDate(fechaIni.getDate() + 1); // Si la semana empieza miercoles la fecha fin de esta semana termina en 3 dias, sabado\n\n    let dateuno = 6 - fechaIni.getDay(); // Si empieza sabado vuela todo XXD\n\n    fechaFin = new Date(this.projectStep2.dbegin_date);\n    fechaFin.setDate(fechaFin.getDate() + (1 + dateuno));\n    let abc = new Date(fechaIni.setDate(fechaIni.getDate() + 0));\n    let abd = new Date(fechaFin.setDate(fechaFin.getDate() + 0));\n    this.listSemanasStart.push(abc);\n    this.listSemanasFinish.push(abd);\n    let newDate = new Date(this.projectStep2.dfinish_date);\n    newDate.setDate(newDate.getDate() + 1);\n    let primeraIteracion = true;\n\n    while (fechaFin <= newDate) {\n      // Si entra es porque fechaFin aun no es menor que newDate\n      let abc;\n\n      if (primeraIteracion) {\n        let sumarPrimeraIteracion = 8 - fechaIni.getDay();\n        abc = new Date(fechaIni.setDate(fechaIni.getDate() + sumarPrimeraIteracion));\n        primeraIteracion = false;\n      } else {\n        abc = new Date(fechaIni.setDate(fechaIni.getDate() + 7));\n      }\n\n      let abd;\n\n      if (abc <= newDate) {\n        abd = new Date(fechaFin.setDate(fechaFin.getDate() + 7));\n\n        if (abd <= newDate) {\n          this.listSemanasStart.push(abc);\n          this.listSemanasFinish.push(abd);\n        } else {\n          let abd2 = new Date(fechaFin.setDate(fechaFin.getDate() - 7));\n          let ultimaSemana = new Date(newDate);\n          ultimaSemana.setDate(ultimaSemana.getDate() - 1);\n\n          while (abd2 < ultimaSemana) {\n            // Mientras que sea menor, para que en la ultima iteracion quede igual\n            abd2.setDate(abd2.getDate() + 1);\n          }\n\n          this.listSemanasStart.push(abc);\n          this.listSemanasFinish.push(abd2);\n        }\n      } else {\n        // Ya no deberia entrar a otra semana si es mayor que el newdate\n        fechaFin.setDate(fechaFin.getDate() + 1);\n      }\n    }\n\n    this.listhoras = []; // Una vez que obtengo las semana se debe crear el arreglo de horas\n\n    for (let index = 0; index < this.listSemanasStart.length; index++) {\n      this.listhoras[index] = 0;\n      this.listCostoPlanificado[index] = 0;\n      this.listCostoReal[index] = 0;\n    }\n  }\n\n  calculateCostoPlanificado() {\n    for (let i = 0; i < this.ncantidadsemanas; i++) {\n      for (let person of this.listProjectEstimate) {\n        let rol = this.listInvestment.find(x => x.nid_rol == person.nid_rol);\n        let hora_estimada_semana = this.ListWeekPerson.filter(x => x.nweeknumber == i + 1 && x.nid_person == person.nid_person).reduce((sum, current) => Number(sum) + Number(current.nhours_asigned), 0);\n        let costoPlanificado = Number(rol.ncost_per_hour) * Number(hora_estimada_semana);\n        this.listCostoPlanificado[i] += Number(costoPlanificado);\n        this.listCostoPlanificado[i] = Number(this.listCostoPlanificado[i].toFixed(2));\n      }\n    }\n  }\n\n  getCostoReal(nid_person, fechaRegistro) {\n    // Number(this.listCost.find(x=>x.nid_person == nid_person).ncost)\n    var histCost = this.listCost.filter(x => x.nid_person == nid_person);\n    histCost.sort(function (a, b) {\n      return a.dcost_date.getTime() - b.dcost_date.getTime();\n    });\n    var ultima_pos = histCost.length - 1;\n\n    if (ultima_pos < 0) {\n      // show error message\n      console.log(\"No hay costos para esta persona\");\n      return 0;\n    } // La lista ordenada DESC\n\n\n    if (fechaRegistro >= histCost[ultima_pos].dcost_date) {\n      return histCost[ultima_pos].ncost;\n    } else {\n      // Validar a que rango corresponde\n      for (let i = 0; i < ultima_pos; i++) {\n        if (fechaRegistro >= histCost[i].dcost_date && fechaRegistro < histCost[i + 1].dcost_date) {\n          return histCost[i].ncost;\n        }\n      }\n    } // Si llega aca, el algoritmo esta mal xd o un personal registro hora cuando no tenia asignado costo (registra 09/10 y su primer costo registrado es 10/10)\n\n\n    console.log(\"Error algoritmo fallido\", nid_person, fechaRegistro); // He tenido problemas porque hay usuarios que tienen su costo 27-3-2023 y registran el 22-03-2023 pues no les retorna una costoReal\n    // En este caso retornaré la primera ingresada\n\n    return histCost[0].ncost;\n  }\n\n  calculo() {\n    let fechaIni;\n    let horas;\n    let personId;\n    this.personHours = [];\n\n    for (let i = 0; i < this.listProjectHoursLog.length; i++) {\n      fechaIni = new Date(this.listProjectHoursLog[i].dregistration_date);\n      personId = this.listProjectHoursLog[i].nid_person;\n      horas = this.listProjectHoursLog[i].nnumber_hours;\n      let costoReal = this.getCostoReal(personId, fechaIni);\n      let sperson = this.listProjectHoursLog[i].sperson;\n      let existingPerson = this.personHours.find(person => person[0] === personId);\n\n      if (!existingPerson) {\n        let newArrayHoursForPerson = this.createArraySemanasWithCeros();\n        this.personHours.push([personId, newArrayHoursForPerson, sperson]); // Agregar nueva persona y sus horas\n      }\n\n      this.PerteneceSemana(fechaIni, horas, costoReal, personId);\n    }\n\n    for (let i = 0; i < this.listProjectHoursExt.length; i++) {\n      fechaIni = new Date(this.listProjectHoursExt[i].dregistration_date);\n      personId = this.listProjectHoursExt[i].nid_person;\n      horas = this.listProjectHoursExt[i].nnumber_hours;\n      let costoReal = this.listProjectHoursExt[i].costohora;\n      let sperson = this.listProjectHoursExt[i].sperson;\n      let existingPerson = this.personHours.find(person => person[0] === personId);\n\n      if (!existingPerson) {\n        let newArrayHoursForPerson = this.createArraySemanasWithCeros();\n        this.personHours.push([personId, newArrayHoursForPerson, sperson]); // Agregar nueva persona y sus horas\n      }\n\n      this.PerteneceSemana(fechaIni, horas, costoReal, personId);\n    } // Lista de todos los integrantes y en caso no este su id dentro de personHours deberia crearles su arreglo con todo 0\n\n\n    for (let i = 0; i < this.listProjectPersonal.length; i++) {\n      let existingPerson2 = this.personHours.find(personHour => personHour[0] == this.listProjectPersonal[i].nid_person);\n\n      if (!existingPerson2) {\n        let newArrayHoursForPerson = this.createArraySemanasWithCeros();\n        this.personHours.push([personId, newArrayHoursForPerson, this.listProjectPersonal[i].sperson]); // Agregar nueva persona y sus horas\n      }\n    }\n  }\n\n  createArraySemanasWithCeros() {\n    let newArrayHoursForPerson = [];\n\n    for (let index = 0; index < this.listSemanasStart.length; index++) {\n      newArrayHoursForPerson[index] = 0;\n    }\n\n    return newArrayHoursForPerson;\n  }\n\n  PerteneceSemana(fechaIni, horas, costoReal, personId) {\n    let semana_pertenece = -1;\n\n    for (let i = 0; i < this.listSemanasFinish.length; i++) {\n      if (fechaIni >= this.listSemanasStart[i] && fechaIni <= this.listSemanasFinish[i]) {\n        semana_pertenece = i;\n        break;\n      }\n    }\n\n    if (semana_pertenece == -1) {\n      return;\n    }\n\n    this.listhoras[semana_pertenece] += horas;\n    this.listCostoReal[semana_pertenece] += Number(horas * costoReal);\n    this.listCostoReal[semana_pertenece] = Number(this.listCostoReal[semana_pertenece].toFixed(2)); // Agrego horas en las semanas de una persona\n\n    this.personHours.find(person => person[0] === personId)[1][semana_pertenece] += horas;\n  }\n\n  calcularCostoReal() {\n    let fechaRegistro;\n    let horas;\n    this.costoReal = 0;\n\n    for (let i = 0; i < this.listProjectHoursLog.length; i++) {\n      fechaRegistro = new Date(this.listProjectHoursLog[i].dregistration_date);\n      fechaRegistro.setDate(fechaRegistro.getDate() + 1);\n      let costoRealIntegrante = this.getCostoReal(this.listProjectHoursLog[i].nid_person, fechaRegistro);\n      horas = this.listProjectHoursLog[i].nnumber_hours;\n      this.costoReal += Number(costoRealIntegrante) * Number(horas);\n    }\n\n    for (let i = 0; i < this.listProjectHoursExt.length; i++) {\n      horas = this.listProjectHoursExt[i].nnumber_hours;\n      let costoReal = this.listProjectHoursExt[i].costohora;\n      this.costoReal += Number(costoReal) * Number(horas);\n    }\n  }\n\n  FilterPersonWeek(nidperson) {\n    let lista = this.ListWeekPerson.filter(x => x.nid_person == nidperson);\n    return lista.slice(0, this.ncantidadsemanas);\n  }\n\n  mensajeError(message) {\n    Swal.fire('Error', message, 'info');\n  }\n\n  llenarGrafico2() {\n    this.grafico2.data.datasets = [];\n    this.cumplimiento_tareasATiempo = 0;\n    this.cumplimiento_tareasFueraDeTiempo = 0;\n    this.cumplimiento_tareasTerminadas = 0;\n    this.cumplimiento_avanceDelProyecto = 0;\n    this.cumplimiento_totalTareas = this.listAvanceProyecto.length;\n\n    for (let i = 0; i < this.listAvanceProyecto.length; i++) {\n      const tarea = this.listAvanceProyecto[i];\n      let color;\n\n      if (tarea.real >= tarea.planificado) {\n        color = \"#00ff00\";\n        tarea.planificado == 100 ? this.cumplimiento_tareasTerminadas += 1 : this.cumplimiento_tareasATiempo += 1;\n      } else {\n        this.cumplimiento_tareasFueraDeTiempo += 1;\n        color = \"#ff0000\";\n      }\n\n      let newData = {\n        label: tarea.name,\n        data: [{\n          x: tarea.planificado,\n          y: tarea.real\n        }],\n        borderWidth: 1,\n        backgroundColor: [color],\n        pointRadius: 8\n      };\n      this.grafico2.data.datasets.push(newData);\n    }\n\n    this.grafico2.update();\n  }\n\n  llenarGrafico3() {\n    this.grafico3.data.labels = this.facturacion_labels;\n    this.grafico3.data.datasets = [];\n    this.grafico3.data.datasets.push({\n      label: 'Esperado',\n      data: this.facturacion_montoesperado,\n      borderWidth: 2\n    });\n    this.grafico3.data.datasets.push({\n      label: 'Real',\n      data: this.facturacion_montoreal,\n      borderWidth: 2\n    });\n    this.grafico3.data.datasets.push({\n      label: 'Facturado',\n      data: this.facturacion_montofacturado,\n      borderWidth: 2\n    });\n    this.grafico3.update();\n  }\n\n  llenarNuevoGrafico() {\n    this.grafico1.data.labels = [];\n    this.grafico1.data.datasets[0].data = [];\n    this.grafico1.data.datasets[1].data = [];\n    this.grafico1.data.labels.push(\"Ingresos\");\n    this.grafico1.data.datasets[0].data.push(this.projectStep5.nexpected_income);\n    this.grafico1.data.datasets[1].data.push(this.ingresosReales);\n    this.grafico1.data.labels.push(\"Costos\");\n    this.grafico1.data.datasets[0].data.push(this.projectStep5.ntotal_investment + this.projectStep5.ntotal_external_cost);\n    this.grafico1.data.datasets[1].data.push(this.costoReal);\n    this.grafico1.data.labels.push(\"Utilidad\");\n    this.grafico1.data.datasets[0].data.push(this.projectStep5.nexpected_utility);\n    this.grafico1.data.datasets[1].data.push(this.ingresosReales - this.costoReal);\n    this.grafico1.update();\n  }\n\n  RenderChart() {\n    this.grafico1 = new Chart(\"barchart1\", {\n      type: 'bar',\n      data: {\n        labels: [],\n        datasets: [{\n          label: 'Esperado',\n          data: [],\n          borderWidth: 1,\n          backgroundColor: [\"#41cfe3\"]\n        }, {\n          label: 'Real',\n          data: [],\n          borderWidth: 1,\n          backgroundColor: [\"#ec7c1c\"]\n        }]\n      },\n      options: {\n        responsive: true,\n        maintainAspectRatio: false,\n        scales: {\n          y: {\n            beginAtZero: true,\n            // min: 0,\n            // suggestedMax: 100,\n            ticks: {\n              callback: function (value, index, ticks) {\n                return \"S/.\" + Number(value).toFixed(0);\n              }\n            }\n          }\n        },\n        datasets: {\n          bar: {\n            barPercentage: 1\n          }\n        },\n        plugins: {\n          title: {\n            display: true,\n            text: 'RENTABILIDAD DEL PROYECTO'\n          },\n          legend: {\n            position: 'bottom'\n          },\n          tooltip: {\n            callbacks: {\n              label: function (context) {\n                let label = context.dataset.label || '';\n\n                if (label) {\n                  label += ': ';\n                }\n\n                if (context.parsed.y !== null) {\n                  label += \"S/.\" + context.parsed.y.toFixed(2);\n                }\n\n                return label;\n              }\n            }\n          },\n          datalabels: {\n            anchor: 'center',\n            align: 'center',\n            font: {\n              weight: 'bold'\n            },\n            color: '#fff',\n            formatter: function (value, context) {\n              return \"S/.\" + Number(value).toFixed(0);\n            }\n          }\n        }\n      }\n    });\n    this.grafico2 = new Chart('chartCanvas', {\n      type: 'scatter',\n      data: {\n        datasets: []\n      },\n      options: {\n        responsive: true,\n        maintainAspectRatio: false,\n        scales: {\n          x: {\n            type: 'linear',\n            position: 'bottom',\n            min: 0,\n            max: 100,\n            title: {\n              display: true,\n              text: 'Avance Planificado'\n            },\n            ticks: {\n              callback: function (value, index, ticks) {\n                return Number(value).toFixed(0) + '%';\n              }\n            }\n          },\n          y: {\n            type: 'linear',\n            position: 'left',\n            min: 0,\n            max: 100,\n            title: {\n              display: true,\n              text: 'Avance Real'\n            },\n            ticks: {\n              callback: function (value, index, ticks) {\n                return Number(value).toFixed(0) + '%';\n              }\n            }\n          }\n        },\n        plugins: {\n          title: {\n            display: true,\n            text: 'CUMPLIMIENTO DEL CRONOGRAMA'\n          },\n          legend: {\n            display: false\n          },\n          tooltip: {\n            callbacks: {\n              label: function (context) {\n                let label = context.dataset.label || '';\n\n                if (label) {\n                  label += ': ';\n                }\n\n                if (context.parsed.x !== null && context.parsed.y !== null) {\n                  const planificado = context.parsed.x;\n                  const real = context.parsed.y;\n                  label += 'Planificado: ' + planificado.toFixed(2) + '%, Real: ' + real.toFixed(2) + '%';\n                }\n\n                return label;\n              }\n            }\n          }\n        }\n      }\n    });\n    this.grafico3 = new Chart('ganttChart', {\n      type: 'line',\n      data: {\n        labels: ['17-Enero', '30-Enero', '1-Febrero'],\n        datasets: [{\n          label: 'Real',\n          data: [1000, 2000, 3000]\n        }, {\n          label: 'Esperado',\n          data: [2000, 3000, 5000]\n        }]\n      },\n      options: {\n        responsive: true,\n        maintainAspectRatio: false,\n        plugins: {\n          legend: {\n            position: 'bottom'\n          },\n          title: {\n            display: true,\n            text: 'Cumplimiento de hitos de facturación del proyecto'\n          }\n        },\n        elements: {\n          line: {\n            backgroundColor: ['#123d63', \"#ec7c1c\", \"#94bb68\"],\n            borderColor: ['#123d63', \"#ec7c1c\", \"#94bb68\"]\n          }\n        }\n      }\n    });\n  }\n\n  indicadorSemaforo(nweeknumber) {\n    let numero = this.listCostoPlanificado[nweeknumber];\n    let numero2 = this.listCostoReal[nweeknumber];\n    return numero >= numero2 ? 'green' : 'red';\n  }\n\n  indicadorSemaforoNumber(nweeknumber) {\n    let numero = this.listCostoPlanificado[nweeknumber];\n    let numero2 = this.listCostoReal[nweeknumber];\n    return (numero - numero2).toFixed(2);\n  }\n\n  downloadAsPDF() {\n    const pdf = new jsPDF(); // Selecciona el elemento HTML que deseas convertir en PDF\n\n    const element = document.getElementById('pruebita'); // Convierte el elemento en una imagen utilizando html2canvas\n\n    html2canvas(element).then(canvas => {\n      const imageData = canvas.toDataURL('image/png'); // Agrega la imagen al PDF\n\n      pdf.addImage(imageData, 'PNG', 10, 10, 190, 0); // Descarga el PDF\n\n      pdf.save('vista.pdf');\n    });\n  }\n\n}\n\nReporteExportablePdfComponent.ɵfac = function ReporteExportablePdfComponent_Factory(t) {\n  return new (t || ReporteExportablePdfComponent)(i0.ɵɵdirectiveInject(i1.MastertableService), i0.ɵɵdirectiveInject(i2.NgxSpinnerService), i0.ɵɵdirectiveInject(i3.ProjectTypeService), i0.ɵɵdirectiveInject(i4.ProjectService), i0.ɵɵdirectiveInject(i5.PersonService));\n};\n\nReporteExportablePdfComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ReporteExportablePdfComponent,\n  selectors: [[\"app-reporte-exportable-pdf\"]],\n  decls: 150,\n  vars: 34,\n  consts: [[1, \"app-content\", \"content\", \"bg-white\"], [1, \"content-wrapper\"], [1, \"content-header\", \"row\"], [1, \"content-header-left\", \"col-md-6\", \"col-12\"], [1, \"content-header-title\"], [1, \"row\", \"breadcrumbs-top\"], [1, \"breadcrumb-wrapper\", \"col-12\"], [1, \"breadcrumb\"], [1, \"breadcrumb-item\"], [\"routerLink\", \"/manage/inicio\"], [\"routerLink\", \"/manage/indicador-gestion\"], [1, \"breadcrumb-item\", \"active\"], [\"id\", \"pruebita\", 1, \"content-body\"], [1, \"row\"], [1, \"col-lg-12\"], [1, \"card\"], [1, \"card-header\"], [1, \"card-title\"], [1, \"heading-elements-toggle\"], [1, \"la\", \"la-ellipsis-v\", \"font-medium-3\"], [1, \"card-content\", \"collapse\", \"show\"], [1, \"card-body\"], [1, \"form-group\", \"col-md-2\", \"col-sm-12\"], [2, \"width\", \"100%\"], [\"type\", \"text\", \"aria-label\", \"Number\", \"matInput\", \"\", 3, \"formControl\", \"ngModel\", \"matAutocomplete\", \"ngModelChange\", \"change\"], [3, \"optionSelected\"], [\"auto\", \"matAutocomplete\"], [\"style\", \"font-size:12px\", 3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"form-group\", \"col-md-3\", \"col-sm-12\"], [\"type\", \"text\", \"aria-label\", \"Number\", \"matInput\", \"\", 3, \"formControl\", \"matAutocomplete\", \"ngModel\", \"ngModelChange\", \"change\"], [2, \"width\", \"300px\", 3, \"optionSelected\"], [\"auto2\", \"matAutocomplete\"], [\"required\", \"\", 1, \"select2\", \"form-control\", \"block\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"value\", \"0\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"col-md-2\", \"col-sm-12\"], [1, \"form-actions\"], [\"type\", \"button\", 1, \"btn\", \"btn-outline-info\", \"btn-active\", 3, \"click\"], [1, \"la\", \"la-search\"], [\"type\", \"button\", 1, \"btn\", 2, \"padding\", \"0\", \"border\", \"none\", \"background\", \"transparent\", 3, \"click\"], [\"src\", \"../../../../../assets/images/icons/excel1.png\", 2, \"width\", \"24px\", \"height\", \"24px\"], [1, \"row\", 2, \"overflow\", \"auto !important\"], [1, \"form-group\"], [1, \"col-md-12\"], [1, \"table-responsive\"], [1, \"table\", \"table-striped\", \"table-bordered\", 2, \"table-layout\", \"fixed\"], [2, \"text-align\", \"center\", \"width\", \"200px !important\"], [\"style\", \"text-align: center; width: 80px !important;\", \"class\", \"hasTooltip\", 4, \"ngFor\", \"ngForOf\"], [1, \"hasTooltip2\", 2, \"text-align\", \"center\", \"width\", \"200px !important\"], [\"style\", \"text-align: center; width: 200px !important;\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngFor\", \"ngForOf\"], [2, \"text-align\", \"center\"], [2, \"height\", \"500px\"], [\"id\", \"barchart1\"], [\"id\", \"chartCanvas\"], [1, \"table-responsive\", 2, \"padding\", \"30px\"], [\"scope\", \"col\", 2, \"text-align\", \"center\"], [\"id\", \"ganttChart\"], [\"name\", \"SpinnerProject\", \"bdColor\", \"rgba(51,51,51,0.8)\", \"size\", \"large\", \"color\", \"#fff\", \"type\", \"ball-spin-clockwise\", 3, \"fullScreen\"], [2, \"color\", \"white\"], [2, \"font-size\", \"12px\", 3, \"value\"], [3, \"value\"], [1, \"hasTooltip\", 2, \"text-align\", \"center\", \"width\", \"80px !important\"], [1, \"form-group\", \"text-left\"], [1, \"circulooo\", 2, \"margin\", \"auto\", 3, \"ngStyle\"], [\"style\", \"text-align: center;\", 4, \"ngFor\", \"ngForOf\"]],\n  template: function ReporteExportablePdfComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"h3\", 4);\n      i0.ɵɵtext(5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"div\", 5)(7, \"div\", 6)(8, \"ol\", 7)(9, \"li\", 8)(10, \"a\", 9);\n      i0.ɵɵtext(11, \"Inicio\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(12, \"li\", 8)(13, \"a\", 10);\n      i0.ɵɵtext(14);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(15, \"li\", 11);\n      i0.ɵɵtext(16);\n      i0.ɵɵelementEnd()()()()()();\n      i0.ɵɵelementStart(17, \"div\", 12)(18, \"div\", 13)(19, \"div\", 14)(20, \"div\", 15)(21, \"div\", 16)(22, \"h4\", 17);\n      i0.ɵɵtext(23, \" FILTROS \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(24, \"a\", 18);\n      i0.ɵɵelement(25, \"i\", 19);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(26, \"div\", 20)(27, \"div\", 21)(28, \"div\", 13)(29, \"div\", 22)(30, \"label\");\n      i0.ɵɵtext(31, \" C\\u00F3digo Proyecto \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(32, \"mat-form-field\", 23)(33, \"input\", 24);\n      i0.ɵɵlistener(\"ngModelChange\", function ReporteExportablePdfComponent_Template_input_ngModelChange_33_listener($event) {\n        return ctx.filterProject.scodproject = $event;\n      })(\"change\", function ReporteExportablePdfComponent_Template_input_change_33_listener() {\n        return ctx.changeCodigoServicio();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(34, \"mat-autocomplete\", 25, 26);\n      i0.ɵɵlistener(\"optionSelected\", function ReporteExportablePdfComponent_Template_mat_autocomplete_optionSelected_34_listener() {\n        return ctx.changeCodigoServicio();\n      });\n      i0.ɵɵtemplate(36, ReporteExportablePdfComponent_mat_option_36_Template, 2, 2, \"mat-option\", 27);\n      i0.ɵɵpipe(37, \"async\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(38, \"div\", 28)(39, \"label\");\n      i0.ɵɵtext(40, \" Nombre Proyecto \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(41, \"mat-form-field\", 23)(42, \"input\", 29);\n      i0.ɵɵlistener(\"ngModelChange\", function ReporteExportablePdfComponent_Template_input_ngModelChange_42_listener($event) {\n        return ctx.inputNombreServicio = $event;\n      })(\"change\", function ReporteExportablePdfComponent_Template_input_change_42_listener() {\n        return ctx.changeNombreServicio();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(43, \"mat-autocomplete\", 30, 31);\n      i0.ɵɵlistener(\"optionSelected\", function ReporteExportablePdfComponent_Template_mat_autocomplete_optionSelected_43_listener() {\n        return ctx.changeNombreServicio();\n      });\n      i0.ɵɵtemplate(45, ReporteExportablePdfComponent_mat_option_45_Template, 2, 2, \"mat-option\", 27);\n      i0.ɵɵpipe(46, \"async\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(47, \"div\", 22)(48, \"label\");\n      i0.ɵɵtext(49, \" Estado \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(50, \"select\", 32);\n      i0.ɵɵlistener(\"ngModelChange\", function ReporteExportablePdfComponent_Template_select_ngModelChange_50_listener($event) {\n        return ctx.filterProject.nid_status = $event;\n      })(\"change\", function ReporteExportablePdfComponent_Template_select_change_50_listener() {\n        return ctx.changeEstado();\n      });\n      i0.ɵɵelementStart(51, \"option\", 33);\n      i0.ɵɵtext(52, \"-- Seleccione --\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(53, ReporteExportablePdfComponent_option_53_Template, 2, 2, \"option\", 34);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(54, \"div\", 35)(55, \"div\", 36)(56, \"button\", 37);\n      i0.ɵɵlistener(\"click\", function ReporteExportablePdfComponent_Template_button_click_56_listener() {\n        return ctx.search();\n      });\n      i0.ɵɵelement(57, \"i\", 38);\n      i0.ɵɵtext(58, \"\\u00A0Consultar \");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(59, \"div\", 35)(60, \"div\", 36)(61, \"button\", 39);\n      i0.ɵɵlistener(\"click\", function ReporteExportablePdfComponent_Template_button_click_61_listener() {\n        return ctx.downloadAsPDF();\n      });\n      i0.ɵɵelement(62, \"img\", 40);\n      i0.ɵɵtext(63, \" \\u00A0Exportar \");\n      i0.ɵɵelementEnd()()()()()()()()();\n      i0.ɵɵelementStart(64, \"div\", 41)(65, \"div\", 42)(66, \"div\", 43)(67, \"div\", 44)(68, \"table\", 45)(69, \"thead\")(70, \"tr\")(71, \"th\", 46);\n      i0.ɵɵtext(72, \"Avances (S/.) \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(73, ReporteExportablePdfComponent_th_73_Template, 5, 5, \"th\", 47);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(74, \"tbody\")(75, \"tr\")(76, \"th\", 48);\n      i0.ɵɵtext(77, \" Costo Planificado \");\n      i0.ɵɵelementStart(78, \"span\");\n      i0.ɵɵtext(79, \"Hrs Estimadas * Costo/Hora Estimado\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtemplate(80, ReporteExportablePdfComponent_th_80_Template, 2, 1, \"th\", 49);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(81, \"tr\")(82, \"th\", 48);\n      i0.ɵɵtext(83, \" Costo Real \");\n      i0.ɵɵelementStart(84, \"span\");\n      i0.ɵɵtext(85, \"Hrs Registradas * Costo/Hora Real\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtemplate(86, ReporteExportablePdfComponent_th_86_Template, 2, 1, \"th\", 49);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(87, \"tr\")(88, \"th\", 46);\n      i0.ɵɵtext(89, \" Diferencia \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(90, ReporteExportablePdfComponent_th_90_Template, 2, 1, \"th\", 49);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(91, \"tr\")(92, \"th\", 46);\n      i0.ɵɵtext(93, \"Indicador Sem\\u00E1foro\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(94, ReporteExportablePdfComponent_th_94_Template, 3, 3, \"th\", 50);\n      i0.ɵɵelementEnd()()()()()();\n      i0.ɵɵelement(95, \"br\");\n      i0.ɵɵelementStart(96, \"div\", 42)(97, \"div\", 43)(98, \"div\", 44)(99, \"table\", 45)(100, \"thead\")(101, \"tr\")(102, \"th\", 46);\n      i0.ɵɵtext(103, \"Avances (Horas) \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(104, ReporteExportablePdfComponent_th_104_Template, 5, 5, \"th\", 47);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(105, \"tbody\")(106, \"tr\")(107, \"td\", 51);\n      i0.ɵɵtext(108, \"PLANIFICADO\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtemplate(109, ReporteExportablePdfComponent_tr_109_Template, 4, 3, \"tr\", 50);\n      i0.ɵɵelementStart(110, \"td\", 51);\n      i0.ɵɵtext(111, \"REAL\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(112, ReporteExportablePdfComponent_tr_112_Template, 4, 2, \"tr\", 50);\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelement(113, \"br\");\n      i0.ɵɵelementStart(114, \"div\", 14)(115, \"div\", 52);\n      i0.ɵɵelement(116, \"canvas\", 53);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelement(117, \"br\");\n      i0.ɵɵelementStart(118, \"div\", 14)(119, \"div\", 52);\n      i0.ɵɵelement(120, \"canvas\", 54);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(121, \"br\");\n      i0.ɵɵelementStart(122, \"div\", 55)(123, \"table\", 45)(124, \"thead\")(125, \"tr\")(126, \"th\", 56);\n      i0.ɵɵtext(127, \" Total Tareas \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(128, \"th\", 56);\n      i0.ɵɵtext(129, \" Tareas Terminadas \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(130, \"th\", 56);\n      i0.ɵɵtext(131, \" Tareas en Tiempo \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(132, \"th\", 56);\n      i0.ɵɵtext(133, \" Tareas Fuera de Tiempo \");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(134, \"tbody\")(135, \"td\", 51);\n      i0.ɵɵtext(136);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(137, \"td\", 51);\n      i0.ɵɵtext(138);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(139, \"td\", 51);\n      i0.ɵɵtext(140);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(141, \"td\", 51);\n      i0.ɵɵtext(142);\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelement(143, \"br\");\n      i0.ɵɵelementStart(144, \"div\", 14)(145, \"div\", 52);\n      i0.ɵɵelement(146, \"canvas\", 57);\n      i0.ɵɵelementEnd()()()()()();\n      i0.ɵɵelementStart(147, \"ngx-spinner\", 58)(148, \"p\", 59);\n      i0.ɵɵtext(149, \"Please Wait. \");\n      i0.ɵɵelementEnd()();\n    }\n\n    if (rf & 2) {\n      const _r0 = i0.ɵɵreference(35);\n\n      const _r2 = i0.ɵɵreference(44);\n\n      i0.ɵɵadvance(5);\n      i0.ɵɵtextInterpolate(ctx.Title);\n      i0.ɵɵadvance(9);\n      i0.ɵɵtextInterpolate(ctx.BreadLevel01);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate1(\"\", ctx.Title, \" \");\n      i0.ɵɵadvance(17);\n      i0.ɵɵproperty(\"formControl\", ctx.myControl)(\"ngModel\", ctx.filterProject.scodproject)(\"matAutocomplete\", _r0);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(37, 30, ctx.codigoProyecto));\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"formControl\", ctx.myControll)(\"matAutocomplete\", _r2)(\"ngModel\", ctx.inputNombreServicio);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(46, 32, ctx.nombreProyecto));\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngModel\", ctx.filterProject.nid_status);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngForOf\", ctx.listState);\n      i0.ɵɵadvance(11);\n      i0.ɵɵstyleProp(\"display\", ctx.showData ? \"block\" : \"none\");\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"ngForOf\", ctx.arrayNumberWeek);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngForOf\", ctx.listhoras);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngForOf\", ctx.listhoras);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.arrayNumberWeek);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.arrayNumberWeek);\n      i0.ɵɵadvance(10);\n      i0.ɵɵproperty(\"ngForOf\", ctx.arrayNumberWeek);\n      i0.ɵɵadvance(3);\n      i0.ɵɵattribute(\"colspan\", ctx.arrayNumberWeek.length + 1);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngForOf\", ctx.listProjectEstimate);\n      i0.ɵɵadvance(1);\n      i0.ɵɵattribute(\"colspan\", ctx.arrayNumberWeek.length + 1);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngForOf\", ctx.personHours);\n      i0.ɵɵadvance(24);\n      i0.ɵɵtextInterpolate(ctx.cumplimiento_totalTareas);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate(ctx.cumplimiento_tareasTerminadas);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate(ctx.cumplimiento_tareasATiempo);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate(ctx.cumplimiento_tareasFueraDeTiempo);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"fullScreen\", true);\n    }\n  },\n  dependencies: [i6.RouterLinkWithHref, i7.NgForOf, i7.NgStyle, i8.NgSelectOption, i8.ɵNgSelectMultipleOption, i8.DefaultValueAccessor, i8.SelectControlValueAccessor, i8.NgControlStatus, i8.RequiredValidator, i8.NgModel, i8.FormControlDirective, i2.NgxSpinnerComponent, i9.MatAutocomplete, i9.MatAutocompleteTrigger, i10.MatOption, i11.MatFormField, i12.MatInput, i7.AsyncPipe, i7.DatePipe],\n  styles: [\".hasTooltip[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\\r\\n    display: none;\\r\\n    color: #000;\\r\\n    text-decoration: none;\\r\\n    padding-top : 3px;\\r\\n    padding-bottom : 3px;\\r\\n}\\r\\n\\r\\n.hasTooltip[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%] {\\r\\n    display: block;\\r\\n    position: absolute;\\r\\n    background-color: #FFF;\\r\\n    border: 1px solid #CCC;\\r\\n    margin-top: 2px;\\r\\n    margin-left: -47px;\\r\\n}\\r\\n\\r\\n.hasTooltip2[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\\r\\n    display: none;\\r\\n    color: #000;\\r\\n    text-decoration: none;\\r\\n    padding-top : 3px;\\r\\n    padding-bottom : 3px;\\r\\n}\\r\\n\\r\\n.hasTooltip2[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%] {\\r\\n    display: block;\\r\\n    position: absolute;\\r\\n    background-color: #FFF;\\r\\n    border: 1px solid #CCC;\\r\\n    margin-top: 2px;\\r\\n    margin-left: 50px;\\r\\n}\\r\\n\\r\\n.circulooo[_ngcontent-%COMP%]{\\r\\n    width: 30px;\\r\\n    height: 30px;\\r\\n    border-radius: 50%;\\r\\n    background: hsl(120, 10%, 96%);\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlcG9ydGUtZXhwb3J0YWJsZS1wZGYuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLGFBQWE7SUFDYixXQUFXO0lBQ1gscUJBQXFCO0lBQ3JCLGlCQUFpQjtJQUNqQixvQkFBb0I7QUFDeEI7O0FBRUE7SUFDSSxjQUFjO0lBQ2Qsa0JBQWtCO0lBQ2xCLHNCQUFzQjtJQUN0QixzQkFBc0I7SUFDdEIsZUFBZTtJQUNmLGtCQUFrQjtBQUN0Qjs7QUFFQTtJQUNJLGFBQWE7SUFDYixXQUFXO0lBQ1gscUJBQXFCO0lBQ3JCLGlCQUFpQjtJQUNqQixvQkFBb0I7QUFDeEI7O0FBRUE7SUFDSSxjQUFjO0lBQ2Qsa0JBQWtCO0lBQ2xCLHNCQUFzQjtJQUN0QixzQkFBc0I7SUFDdEIsZUFBZTtJQUNmLGlCQUFpQjtBQUNyQjs7QUFFQTtJQUNJLFdBQVc7SUFDWCxZQUFZO0lBR1osa0JBQWtCO0lBQ2xCLDhCQUE4QjtBQUNsQyIsImZpbGUiOiJyZXBvcnRlLWV4cG9ydGFibGUtcGRmLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuaGFzVG9vbHRpcCBzcGFuIHtcclxuICAgIGRpc3BsYXk6IG5vbmU7XHJcbiAgICBjb2xvcjogIzAwMDtcclxuICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZTtcclxuICAgIHBhZGRpbmctdG9wIDogM3B4O1xyXG4gICAgcGFkZGluZy1ib3R0b20gOiAzcHg7XHJcbn1cclxuXHJcbi5oYXNUb29sdGlwOmhvdmVyIHNwYW4ge1xyXG4gICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRkZGO1xyXG4gICAgYm9yZGVyOiAxcHggc29saWQgI0NDQztcclxuICAgIG1hcmdpbi10b3A6IDJweDtcclxuICAgIG1hcmdpbi1sZWZ0OiAtNDdweDtcclxufVxyXG5cclxuLmhhc1Rvb2x0aXAyIHNwYW4ge1xyXG4gICAgZGlzcGxheTogbm9uZTtcclxuICAgIGNvbG9yOiAjMDAwO1xyXG4gICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xyXG4gICAgcGFkZGluZy10b3AgOiAzcHg7XHJcbiAgICBwYWRkaW5nLWJvdHRvbSA6IDNweDtcclxufVxyXG5cclxuLmhhc1Rvb2x0aXAyOmhvdmVyIHNwYW4ge1xyXG4gICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRkZGO1xyXG4gICAgYm9yZGVyOiAxcHggc29saWQgI0NDQztcclxuICAgIG1hcmdpbi10b3A6IDJweDtcclxuICAgIG1hcmdpbi1sZWZ0OiA1MHB4O1xyXG59XHJcblxyXG4uY2lyY3Vsb29ve1xyXG4gICAgd2lkdGg6IDMwcHg7XHJcbiAgICBoZWlnaHQ6IDMwcHg7XHJcbiAgICAtbW96LWJvcmRlci1yYWRpdXM6IDUwJTtcclxuICAgIC13ZWJraXQtYm9yZGVyLXJhZGl1czogNTAlO1xyXG4gICAgYm9yZGVyLXJhZGl1czogNTAlO1xyXG4gICAgYmFja2dyb3VuZDogaHNsKDEyMCwgMTAlLCA5NiUpO1xyXG59Il19 */\"]\n});","map":{"version":3,"mappings":"AACA,SAASA,qBAAT,QAAsC,mCAAtC;AACA,SAASC,WAAT,QAA4B,gBAA5B;AACA,SAAqBC,aAArB,EAAoCC,GAApC,EAAyCC,SAAzC,QAA0D,MAA1D;AAMA,SAASC,IAAT,QAAqB,uBAArB;AAEA,OAAOC,IAAP,MAAiB,aAAjB;AACA,SAAsEC,YAAtE,EAA4GC,YAA5G,QAAgK,6BAAhK;AAGA,SAASC,KAAT,QAAsB,eAAtB;AACA,OAAO,2BAAP;AAEA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AACA,OAAOC,WAAP,MAAwB,aAAxB;;;;;;;;;;;;;;;;;ICsBgDC;IAEIA;IACJA;;;;;IAFIA;IACAA;IAAAA;;;;;;IAcJA;IAEIA;IACJA;;;;;IAFIA;IACAA;IAAAA;;;;;;IAWRA;IACIA;IAAqBA;;;;;IADcA;IACnCA;IAAAA;;;;;;IAwCRA;IAGIA;IACAA;IAAMA;;IAA0DA;;;;;;IADhEA;IAAAA;IACMA;IAAAA;;;;;;IAWVA;IAEEA;IACFA;;;;;;IADEA;IAAAA;;;;;;IAQFA;IAEEA;IACFA;;;;;;IADEA;IAAAA;;;;;;IAOFA;IAEIA;IACJA;;;;;;IADIA;IAAAA;;;;;;;;;;;;IAMAA,2BAAwD,CAAxD,EAAwD,KAAxD,EAAwD,EAAxD;IAEIA;IAEJA;;;;;;IAF2BA;IAAAA;;;;;;IAqB/BA;IAGIA;IACAA;IAAMA;;IAA0DA;;;;;;IADhEA;IAAAA;IACMA;IAAAA;;;;;;IAWVA;IACIA;IACJA;;;;;IADIA;IAAAA;;;;;;IAHRA,2BAA4D,CAA5D,EAA4D,IAA5D,EAA4D,EAA5D;IACqCA;IAAmCA;IACpEA;IAGJA;;;;;;IAJqCA;IAAAA;IACZA;IAAAA;;;;;;IAOrBA;IACIA;IACJA;;;;;IADIA;IAAAA;;;;;;IAHRA,2BAAoD,CAApD,EAAoD,IAApD,EAAoD,EAApD;IACqCA;IAAYA;IAC7CA;IAGJA;;;;;IAJqCA;IAAAA;IACXA;IAAAA;;;;AD5K9D,OAAM,MAAOC,6BAAP,CAAoC;EAyGxCC,YACUC,kBADV,EAEUC,OAFV,EAGUC,kBAHV,EAIUC,cAJV,EAKUC,aALV,EAKsC;IAJ5B;IACA;IACA;IACA;IACA;IA5GH,oBAAe,UAAf;IACA,aAAQ,2BAAR;IAEP,qBAAuC,IAAInB,qBAAJ,EAAvC;IAEA,mBAAqB,EAArB;IACA,yBAA2B,EAA3B;IAEA,iBAA2B,EAA3B;IAMA,iBAAyB,IAAIC,WAAJ,EAAzB;IACA,kBAA0B,IAAIA,WAAJ,EAA1B;IAEA,2BAAsB,EAAtB;IAEA,4BAAgC,IAAhC;IACA,YAAa,IAAII,IAAJ,EAAb;IAEA,mBAAsB,CAAtB;IACA,oBAAuB,GAAvB;IACA,kBAAqB,CAArB,CAoFsC,CA9EtC;;IACA,mBAAc,EAAd;IACA,oBAA6B,IAAIG,YAAJ,EAA7B;IACA,qBAAoC,EAApC;IACA,sBAAyB,CAAzB;IACA,iBAAoB,CAApB;IACA,kBAAqB,CAArB;IACA,gBAA4B,EAA5B;IAEA,oBAA2B,EAA3B;IACA,0BAAuC,EAAvC;IAEA,sBAAyC,EAAzC;IACA,oBAA6B,IAAID,YAAJ,EAA7B;IACA,yBAAkC,EAAlC;IACA,sBAAuC,EAAvC;IACA,wBAA2B,CAA3B;IACA,uBAA4B,EAA5B;IACA,2BAA4B,EAA5B;IAEA,wBAAyB,EAAzB;IACA,yBAA0B,EAA1B;IACA,iBAAoB,EAApB;IACA,4BAA+B,EAA/B;IACA,qBAAwB,EAAxB;IAGA,2BAAwC,EAAxC;IAIA,yBAAoB,CAApB;IAGA,iCAA4B,EAA5B;IACA,kCAA6B,EAA7B;IACA,6BAAwB,EAAxB;IACA,0BAAqB,EAArB;IAEA,eAAU,IAAIa,GAAJ,CAAQ,CAChB,CAAC,CAAD,EAAI,OAAJ,CADgB,EAEhB,CAAC,CAAD,EAAI,SAAJ,CAFgB,EAGhB,CAAC,CAAD,EAAI,OAAJ,CAHgB,EAIhB,CAAC,CAAD,EAAI,OAAJ,CAJgB,EAKhB,CAAC,CAAD,EAAI,MAAJ,CALgB,EAMhB,CAAC,CAAD,EAAI,OAAJ,CANgB,EAOhB,CAAC,CAAD,EAAI,OAAJ,CAPgB,EAQhB,CAAC,CAAD,EAAI,QAAJ,CARgB,EAShB,CAAC,CAAD,EAAI,YAAJ,CATgB,EAUhB,CAAC,CAAD,EAAI,SAAJ,CAVgB,EAWhB,CAAC,EAAD,EAAK,WAAL,CAXgB,EAYhB,CAAC,EAAD,EAAK,WAAL,CAZgB,CAAR,CAAV;IAcA,kBAAuB,EAAvB;IAEA,mBAAsB,EAAtB;IACA,mBAAsB,EAAtB;IAEA,eAAkB,EAAlB;IACA,eAAkB,EAAlB;IAEA,kBAAa,EAAb;IACA,2BAA6B,EAA7B;IAGA,gBAAW,KAAX;IAEA,kCAA6B,CAA7B;IACA,wCAAmC,CAAnC;IACA,qCAAgC,CAAhC;IACA,sCAAiC,CAAjC;IACA,gCAA2B,CAA3B;IASE,KAAKC,aAAL,CAAmBC,UAAnB,CAA8BC,YAA9B,GAA6C,KAAKC,YAAlD;IACA,KAAKH,aAAL,CAAmBC,UAAnB,CAA8BG,UAA9B,GAA2C,KAAKC,UAAhD;IACA,KAAKL,aAAL,CAAmBC,UAAnB,CAA8BK,WAA9B,GAA4C,KAAKC,WAAjD;EACD;;EAEDC,QAAQ;IACN,KAAKC,QAAL,GAAgB,KAAhB;IAEA,KAAKC,WAAL;;IAEA,IAAIC,cAAc,CAACC,OAAf,CAAuB,OAAvB,MAAoC,IAAxC,EAA8C;MAC5C,KAAKC,IAAL,GAAYC,IAAI,CAACC,KAAL,CAAWJ,cAAc,CAACC,OAAf,CAAuB,MAAvB,CAAX,CAAZ;IACD;;IAED,KAAKI,QAAL;IACA,KAAKC,sBAAL;IACA,KAAKC,YAAL;IAEA,KAAKC,cAAL,GAAsB,KAAKC,SAAL,CAAeC,YAAf,CACrBC,IADqB,CAEpBvC,SAAS,CAAC,EAAD,CAFW,EAGpBD,GAAG,CAAEyC,GAAD,IAAc,KAAKC,MAAL,CAAYD,GAAZ,CAAf,CAHiB,CAAtB;IAMF,KAAKE,cAAL,GAAsB,KAAKC,UAAL,CAAgBL,YAAhB,CACnBC,IADmB,CAElBvC,SAAS,CAAC,EAAD,CAFS,EAGlBD,GAAG,CAAEyC,GAAD,IAAc,KAAKI,OAAL,CAAaJ,GAAb,CAAf,CAHe,CAAtB;EAOC;;EAEDC,MAAM,CAACD,GAAD,EAAY;IAChB,OAAO,KAAKK,iBAAL,CAAuBJ,MAAvB,CAA8BK,OAAO,IAC1CA,OAAO,CAACC,WAAR,CAAoBC,WAApB,GAAkCC,OAAlC,CAA0CT,GAAG,CAACQ,WAAJ,EAA1C,MAAiE,CAD5D,CAAP;EAED;;EAEDJ,OAAO,CAACJ,GAAD,EAAY;IACjB,OAAO,KAAKK,iBAAL,CAAuBJ,MAAvB,CAA8BK,OAAO,IAC1CA,OAAO,CAACI,YAAR,CAAqBF,WAArB,GAAmCC,OAAnC,CAA2CT,GAAG,CAACQ,WAAJ,EAA3C,MAAkE,CAD7D,CAAP;EAED;;EAEDG,oBAAoB;IAClB,IAAIC,QAAQ,GAAG,KAAKC,WAAL,CAAiBC,IAAjB,CAAsBR,OAAO,IAAIA,OAAO,CAACI,YAAR,IAAwB,KAAKK,mBAA9D,CAAf;;IACA,IAAGH,QAAQ,KAAK,IAAb,IAAqBA,QAAQ,KAAKI,SAArC,EAAgD;MAC9C,KAAKvC,aAAL,CAAmB8B,WAAnB,GAAiCK,QAAQ,CAACL,WAA1C;IACD;EACF;;EAEDU,oBAAoB;IAClBC,OAAO,CAACC,GAAR,CAAY,KAAK1C,aAAL,CAAmB8B,WAA/B;IACA,IAAIK,QAAQ,GAAG,KAAKC,WAAL,CAAiBC,IAAjB,CAAsBR,OAAO,IAAIA,OAAO,CAACC,WAAR,IAAuB,KAAK9B,aAAL,CAAmB8B,WAA3E,CAAf;;IACA,IAAGK,QAAQ,KAAK,IAAb,IAAqBA,QAAQ,KAAKI,SAArC,EAAgD;MAC9C,KAAKD,mBAAL,GAA2BH,QAAQ,CAACF,YAApC;IACD;EACF;;EAEDU,YAAY;IACV,IAAG,KAAK3C,aAAL,CAAmB4C,UAAnB,IAAiC,CAApC,EAAuC;MACrC,KAAKhB,iBAAL,GAAyB,KAAKQ,WAA9B;IACD,CAFD,MAEO;MACL,IAAIS,MAAM,GAAG,KAAKC,SAAL,CAAeT,IAAf,CAAoBU,KAAK,IAAIA,KAAK,CAACC,oBAAN,IAA8B,KAAKhD,aAAL,CAAmB4C,UAA9E,EAA0FK,YAA1F,CAAuGC,WAAvG,EAAb;MACA,KAAKtB,iBAAL,GAAyB,KAAKQ,WAAL,CAAiBZ,MAAjB,CAAwBW,QAAQ,IAAIA,QAAQ,CAACgB,WAAT,CAAqBD,WAArB,MAAsCL,MAA1E,CAAzB;IACD;;IACD,KAAKzB,SAAL,CAAegC,QAAf,CAAwB,EAAxB;IACA,KAAK1B,UAAL,CAAgB0B,QAAhB,CAAyB,EAAzB;EACD;;EAEDC,WAAW;IACT,KAAKjC,SAAL,CAAegC,QAAf,CAAwB,EAAxB;IACA,KAAK1B,UAAL,CAAgB0B,QAAhB,CAAyB,EAAzB;EACD;;EAEDpC,QAAQ;IACN,KAAKrB,OAAL,CAAa2D,IAAb,CAAkB,gBAAlB,EADM,CAEN;;IACA,KAAK5D,kBAAL,CAAwB6D,cAAxB,CAAuC,EAAvC,EAA2CC,SAA3C,CAAsDC,QAAD,IAAkB;MACrE,KAAKX,SAAL,GAAiBW,QAAjB;MACA,KAAKX,SAAL,GAAiB,KAAKA,SAAL,CAAetB,MAAf,CAAsBkC,CAAC,IAAIA,CAAC,CAACT,YAAF,IAAkB,QAAlB,IAA+BS,CAAC,CAACT,YAAF,IAAkB,SAA5E,CAAjB;MAEA,KAAKtD,OAAL,CAAagE,IAAb,CAAkB,gBAAlB;IAED,CAND,EAMIC,KAAD,IAAU;MACXnB,OAAO,CAACmB,KAAR,CAAcA,KAAd;MACA,KAAKjE,OAAL,CAAagE,IAAb,CAAkB,gBAAlB;IACD,CATD;EAUD;;EAED1C,sBAAsB;IAEpB,KAAKtB,OAAL,CAAa2D,IAAb,CAAkB,gBAAlB;IACA,KAAK1D,kBAAL,CAAwBiE,eAAxB,GAA0CL,SAA1C,CAAqDC,QAAD,IAAkB;MAEpE,IAAIA,QAAQ,IAAI,IAAhB,EAAsB;QACpB,KAAKzD,aAAL,CAAmB8D,gBAAnB,GAAsC,CAAtC;QACA;MACD;;MACD,KAAKC,uBAAL,GAA+BN,QAA/B;;MACA,IAAI,KAAKM,uBAAL,CAA6BC,MAA7B,GAAsC,CAA1C,EAA6C;QAC3C,KAAKhE,aAAL,CAAmB8D,gBAAnB,GAAsC,CAAtC;MACD;;MACD,KAAKnE,OAAL,CAAagE,IAAb,CAAkB,gBAAlB;IACD,CAXD,EAWIC,KAAD,IAAU;MACXnB,OAAO,CAACmB,KAAR,CAAcA,KAAd;MACA,KAAKjE,OAAL,CAAagE,IAAb,CAAkB,gBAAlB;IACD,CAdD;EAeD;;EAEDzC,YAAY;IACV,KAAKlB,aAAL,CAAmBiE,WAAnB,GAAiC,CAAjC;IACA,KAAKjE,aAAL,CAAmB4C,UAAnB,GAAgC,CAAhC;;IAEA,IAAG,KAAKsB,oBAAR,EAA8B;MAC5B,KAAKlE,aAAL,CAAmBiE,WAAnB,GAA+B,CAA/B;MACA,KAAKjE,aAAL,CAAmBmE,UAAnB,GAAgC,CAAhC;IACD,CAHD,MAGO;MACL,KAAKnE,aAAL,CAAmBiE,WAAnB,GAA+B,CAA/B;MACA,KAAKjE,aAAL,CAAmBmE,UAAnB,GAAgC,KAAKtD,IAAL,CAAUsD,UAA1C;IACD;;IAED,KAAKxE,OAAL,CAAa2D,IAAb;IACA,KAAKzD,cAAL,CAAoBuE,4BAApB,CAAiD,KAAKpE,aAAtD,EAAqEwD,SAArE,CACGa,GAAD,IAAa;MACX,IAAI;QACF,IAAIA,GAAG,IAAI,IAAX,EAAiB;UACfpF,IAAI,CAACqF,IAAL,CAAU;YACRC,IAAI,EAAE,OADE;YAERC,KAAK,EAAE,4CAFC,CAGR;;UAHQ,CAAV;QAKD;;QACD,KAAK7E,OAAL,CAAagE,IAAb;QACA,KAAKvB,WAAL,GAAmBiC,GAAG,CAACI,IAAvB;QACA,KAAK7C,iBAAL,GAAyByC,GAAG,CAACI,IAA7B;QACA,KAAKpB,WAAL;QACA,KAAKhD,UAAL,GAAkBgE,GAAG,CAACpE,UAAJ,CAAeI,UAAjC;MACD,CAbD,CAaE,OAAOqE,CAAP,EAAU;QACV,KAAK/E,OAAL,CAAagE,IAAb;QACA,KAAKvB,WAAL,GAAmB,IAAnB;QACA,KAAK/B,UAAL,GAAkB,CAAlB;MACD;IACF,CApBH;EAsBD;;EAEDsE,MAAM;IACJ,KAAKlE,QAAL,GAAgB,IAAhB;IACA,KAAKqB,WAAL,GAAmB,KAAK9B,aAAL,CAAmB8B,WAAtC;IACA,KAAK8C,gBAAL;EACD;;EAEDA,gBAAgB;IACd,IAAIC,YAAY,GAAGhG,aAAa,CAAC,KAAKgB,cAAL,CAAoBiF,eAApB,CAAoC,KAAKhD,WAAzC,CAAD,CAAhC;IACA,IAAIiD,YAAY,GAAGlG,aAAa,CAAC,KAAKgB,cAAL,CAAoBmF,eAApB,CAAoC,KAAKlD,WAAzC,CAAD,CAAhC;IACA,IAAImD,YAAY,GAAGpG,aAAa,CAAC,KAAKgB,cAAL,CAAoBqF,eAApB,CAAoC,KAAKpD,WAAzC,CAAD,CAAhC,CAHc,CAKd;;IACA,IAAIqD,mBAAmB,GAAGtG,aAAa,CAAC,KAAKgB,cAAL,CAAoBuF,mBAApB,CAAwC,KAAKtD,WAA7C,CAAD,CAAvC,CANc,CAQd;;IACA,IAAIuD,gBAAgB,GAAGxG,aAAa,CAAC,KAAKiB,aAAL,CAAmBwF,0BAAnB,CAA8C,KAAKxD,WAAnD,CAAD,CAApC,CATc,CAWd;;IACA,IAAIyD,cAAc,GAAG1G,aAAa,CAAC,KAAKgB,cAAL,CAAoB2F,oBAApB,CAAyC,KAAK1D,WAA9C,CAAD,CAAlC,CAZc,CAcd;;IACA,IAAI2D,gBAAgB,GAAG5G,aAAa,CAAC,KAAKgB,cAAL,CAAoB6F,kBAApB,CAAuC,KAAK5D,WAA5C,EAAyD,CAAzD,CAAD,CAApC,CAfc,CAiBd;;IACA,IAAI6D,gBAAgB,GAAE9G,aAAa,CAAC,KAAKgB,cAAL,CAAoB+F,kBAApB,CAAuC,KAAK9D,WAA5C,CAAD,CAAnC,CAlBc,CAoBd;;IACA,IAAI+D,sBAAsB,GAAEhH,aAAa,CAAC,KAAKgB,cAAL,CAAoBiG,kBAApB,CAAuC,KAAKhE,WAA5C,CAAD,CAAzC,CArBc,CAuBd;;IACA,IAAIiE,mBAAmB,GAAGlH,aAAa,CAAC,KAAKgB,cAAL,CAAoBmG,kBAApB,CAAuC,KAAKlE,WAA5C,CAAD,CAAvC;IAEA,KAAKnC,OAAL,CAAa2D,IAAb,CAAkB,gBAAlB;IACA2C,OAAO,CAACC,GAAR,CAAY,CAACrB,YAAD,EAAeE,YAAf,EAA6BM,gBAA7B,EAA+CE,cAA/C,EAA+DE,gBAA/D,EAAiFE,gBAAjF,EAAmGV,YAAnG,EAAiHE,mBAAjH,EAAsIU,sBAAtI,EAA8JE,mBAA9J,CAAZ,EAAgMI,IAAhM,CAAsMC,KAAD,IAAe;MAClN,KAAKzG,OAAL,CAAagE,IAAb,CAAkB,gBAAlB,EADkN,CAIlN;;MACA,KAAK0C,cAAL,GAAsBD,KAAK,CAAC,CAAD,CAAL,CAASC,cAA/B,CALkN,CAOlN;;MACA,KAAKtB,YAAL,GAAoBqB,KAAK,CAAC,CAAD,CAAzB;;MAEA,IAAG,KAAKrB,YAAL,CAAkBuB,SAAlB,IAA+B,CAAlC,EAAqC;QACnC,KAAKC,UAAL,GAAkB,KAAlB;MACD,CAFD,MAEO;QACL,KAAKA,UAAL,GAAkB,GAAlB;MACD;;MAED,KAAKC,WAAL,GAAmB,KAAKzB,YAAL,CAAkB0B,WAAlB,CAA8BC,SAA9B,CAAwC,CAAxC,EAA0C,CAA1C,CAAnB;MACA,KAAKC,OAAL,GAAe,KAAK5B,YAAL,CAAkB0B,WAAlB,CAA8BC,SAA9B,CAAwC,CAAxC,EAA0C,CAA1C,CAAf;MACA,KAAKE,WAAL,GAAmB,KAAK7B,YAAL,CAAkB8B,YAAlB,CAA+BH,SAA/B,CAAyC,CAAzC,EAA2C,CAA3C,CAAnB;MACA,KAAKI,OAAL,GAAe,KAAK/B,YAAL,CAAkB8B,YAAlB,CAA+BH,SAA/B,CAAyC,CAAzC,EAA2C,CAA3C,CAAf;MACA,KAAKK,gBAAL,GAAwB,KAAKhC,YAAL,CAAkBiC,MAA1C;MACA,KAAKC,eAAL,GAAuB,IAAIC,KAAJ,CAAkB,KAAKH,gBAAvB,CAAvB;MACA,KAAKI,sBAAL,GAtBkN,CAwBlN;;MACA,KAAKC,QAAL,GAAgBhB,KAAK,CAAC,CAAD,CAArB;;MACA,IAAG,KAAKgB,QAAL,KAAkB,IAAlB,IAA0B,KAAKA,QAAL,KAAkB7E,SAA/C,EAA0D;QACxD,KAAK8E,YAAL,CAAkB,mCAAlB;QACA;MACD;;MACD5E,OAAO,CAACC,GAAR,CAAY,oBAAZ,EAAkC,KAAK0E,QAAvC;MAEA,KAAKA,QAAL,CAAcE,OAAd,CAAsBC,OAAO,IAAG;QAC9BA,OAAO,CAACC,UAAR,GAAqB,IAAIC,IAAJ,CAASF,OAAO,CAACC,UAAjB,CAArB;MACD,CAFD,EAhCkN,CAoClN;;MACA,KAAKE,cAAL,GAAsBtB,KAAK,CAAC,CAAD,CAA3B,CArCkN,CAwClN;;MACA,KAAKuB,mBAAL,GAA2BvB,KAAK,CAAC,CAAD,CAAhC,CAzCkN,CA0ClN;;MACA,KAAKwB,mBAAL,GAA2BxB,KAAK,CAAC,CAAD,CAAL,CAAS5E,MAAT,CAAgBkC,CAAC,IAAGA,CAAC,CAACmE,WAAF,IAAiB,KAArC,CAA3B,CA3CkN,CA4ClN;;MACA,KAAKC,4BAAL,GAAoC1B,KAAK,CAAC,CAAD,CAAL,CAAS5E,MAAT,CAAgBuG,EAAE,IAAIA,EAAE,CAACF,WAAH,IAAkB,IAAxC,CAApC,CA7CkN,CAgDlN;;MACA,KAAKG,yBAAL;;MAEA,IAAG5B,KAAK,CAAC,CAAD,CAAL,KAAY,IAAZ,IAAoBA,KAAK,CAAC,CAAD,CAAL,KAAY7D,SAAnC,EAA8C;QAC5C,KAAK8E,YAAL,CAAkB,6CAAlB;QACA;MACD;;MAED,KAAKY,mBAAL,GAA2B7B,KAAK,CAAC,CAAD,CAAL,CAAS5E,MAAT,CAAgBkC,CAAC,IAAIA,CAAC,CAACwE,MAAF,IAAY,GAAjC,CAA3B,CAxDkN,CA0DlN;;MACA,KAAKjD,YAAL,GAAoBmB,KAAK,CAAC,CAAD,CAAzB;MACA3D,OAAO,CAACC,GAAR,CAAY,KAAKuC,YAAjB,EA5DkN,CA8DlN;;MACA,KAAKkD,aAAL,GAAqB/B,KAAK,CAAC,CAAD,CAA1B;MACA,KAAKgC,kBAAL,GAhEkN,CAkElN;;MACA,KAAKC,YAAL,GAAoBjC,KAAK,CAAC,CAAD,CAAzB;;MACA,IAAG,KAAKiC,YAAL,IAAqB,IAArB,IAA6B,KAAKA,YAAL,CAAkBrE,MAAlB,IAA4B,CAA5D,EAA+D;QAC7D,KAAKsE,kBAAL,GAA0B,KAAKD,YAAL,CAAkB,CAAlB,EAAqBE,kBAA/C;QACA,KAAKC,cAAL;MACD,CAHD,MAGO;QACL,KAAKF,kBAAL,GAA0B,EAA1B;MACD;;MAED,IAAGlC,KAAK,CAAC,CAAD,CAAL,IAAU,IAAb,EAAkB;QAChB,KAAKqC,mBAAL,GAA2BrC,KAAK,CAAC,CAAD,CAAL,CAAS5E,MAAT,CAAgBkC,CAAC,IAAIA,CAAC,CAACwE,MAAF,IAAY,GAAjC,CAA3B;QACAzF,OAAO,CAACC,GAAR,CAAY,KAAK+F,mBAAjB;MACD,CAHD,MAGO;QACL,KAAKA,mBAAL,GAA2B,EAA3B;MACD;;MAGD,KAAKC,OAAL;MACA,KAAKC,iBAAL;MACA,KAAKC,kBAAL;IAED,CAvFD;EAwFD;;EAEDR,kBAAkB;IAChB,IAAIS,QAAQ,GAAG,EAAf;IACA,IAAIC,IAAI,GAAG,EAAX;IACA,IAAIC,SAAS,GAAG,EAAhB;IAEA,KAAKC,yBAAL,GAAiC,EAAjC;IACA,KAAKC,0BAAL,GAAkC,EAAlC;IACA,KAAKC,qBAAL,GAA6B,EAA7B;IACA,KAAKC,kBAAL,GAA0B,EAA1B;;IAEA,IAAG,KAAKhB,aAAL,IAAsB,IAAzB,EAA+B;MAC7B,KAAKiB,cAAL,GAAsB,CAAtB;MACA,KAAKjB,aAAL,CAAmBb,OAAnB,CAA2B+B,IAAI,IAAG;QAChC,IAAIC,aAAa,GAAG,IAAI7B,IAAJ,CAAS4B,IAAI,CAACE,aAAd,CAApB;QACAD,aAAa,CAACE,OAAd,CAAsBF,aAAa,CAACG,OAAd,KAA0B,CAAhD;QACAH,aAAa,CAACI,QAAd,CAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B;QACAb,QAAQ,CAACc,IAAT,CAAc,CAACL,aAAD,EAAgB,CAAhB,EAAmBD,IAAI,CAACO,OAAxB,CAAd;;QAEA,IAAGP,IAAI,CAACQ,SAAR,EAAmB;UACjB,IAAIC,cAAc,GAAG,IAAIrC,IAAJ,CAAS4B,IAAI,CAACU,aAAd,CAArB;UACAD,cAAc,CAACN,OAAf,CAAuBM,cAAc,CAACL,OAAf,KAA2B,CAAlD;UACAK,cAAc,CAACJ,QAAf,CAAwB,CAAxB,EAA0B,CAA1B,EAA4B,CAA5B,EAA8B,CAA9B;UACAX,SAAS,CAACY,IAAV,CAAe,CAACG,cAAD,EAAiB,CAAjB,EAAoBT,IAAI,CAACO,OAAzB,CAAf;QACD;;QAED,IAAGP,IAAI,CAACW,KAAR,EAAe;UACb,KAAKZ,cAAL,IAAwBa,MAAM,CAACZ,IAAI,CAACO,OAAN,CAA9B;UACA,IAAIM,SAAS,GAAG,IAAIzC,IAAJ,CAAS4B,IAAI,CAACc,qBAAd,CAAhB;UACAD,SAAS,CAACV,OAAV,CAAkBU,SAAS,CAACT,OAAV,KAAoB,CAAtC;UACAS,SAAS,CAACR,QAAV,CAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB;UACAZ,IAAI,CAACa,IAAL,CAAU,CAACO,SAAD,EAAY,CAAZ,EAAeb,IAAI,CAACO,OAApB,CAAV;QACD;MAEF,CArBD;MAuBA,IAAIQ,QAAQ,GAAG,CAAC,GAAGvB,QAAJ,EAAc,GAAGC,IAAjB,EAAuB,GAAGC,SAA1B,CAAf;MACAqB,QAAQ,CAACC,IAAT,CAAc,CAACC,CAAD,EAA4BC,CAA5B,KAA0DD,CAAC,CAAC,CAAD,CAAD,CAAKE,OAAL,KAAiBD,CAAC,CAAC,CAAD,CAAD,CAAKC,OAAL,EAAzF;MAEA,IAAIC,YAAY,GAAa,EAA7B;MACA,IAAIC,aAAa,GAAW,EAA5B;;MAEA,KAAK,IAAIC,KAAT,IAAkBP,QAAlB,EAA4B;QAC1B,IAAIQ,WAAW,GAAW,KAAKC,mBAAL,CAAyBF,KAAK,CAAC,CAAD,CAA9B,CAA1B;;QACA,IAAIC,WAAW,KAAKF,aAApB,EAAmC;UACjCD,YAAY,CAACd,IAAb,CAAkBiB,WAAlB;UACAF,aAAa,GAAGE,WAAhB;QACD;MACF;;MAED,IAAIE,aAAa,GAAE,EAAnB;MACA,IAAIC,cAAc,GAAE,EAApB;MACA,IAAIC,SAAS,GAAG,EAAhB;;MAEA,KAAI,IAAIL,KAAR,IAAiBF,YAAjB,EAA+B;QAC7BK,aAAa,CAACnB,IAAd,CAAmB,CAACgB,KAAD,EAAQ,CAAR,CAAnB;QACAI,cAAc,CAACpB,IAAf,CAAoB,CAACgB,KAAD,EAAQ,CAAR,CAApB;QACAK,SAAS,CAACrB,IAAV,CAAe,CAACgB,KAAD,EAAQ,CAAR,CAAf;MACD;;MAED,KAAK,IAAIA,KAAT,IAAkBP,QAAlB,EAA4B;QAC1B,IAAIQ,WAAW,GAAW,KAAKC,mBAAL,CAAyBF,KAAK,CAAC,CAAD,CAA9B,CAA1B;QACA,IAAIM,UAAJ;;QACA,IAAGN,KAAK,CAAC,CAAD,CAAL,IAAY,CAAf,EAAkB;UAChBM,UAAU,GAAGH,aAAa,CAACzI,IAAd,CAAmBqB,CAAC,IAAEA,CAAC,CAAC,CAAD,CAAD,IAAQkH,WAA9B,CAAb;UACAK,UAAU,CAAC,CAAD,CAAV,IAAiBN,KAAK,CAAC,CAAD,CAAtB;QACD;;QACD,IAAGA,KAAK,CAAC,CAAD,CAAL,IAAY,CAAf,EAAkB;UAChBM,UAAU,GAAGF,cAAc,CAAC1I,IAAf,CAAoBqB,CAAC,IAAEA,CAAC,CAAC,CAAD,CAAD,IAAQkH,WAA/B,CAAb;UACAK,UAAU,CAAC,CAAD,CAAV,IAAiBN,KAAK,CAAC,CAAD,CAAtB;QACD;;QACD,IAAGA,KAAK,CAAC,CAAD,CAAL,IAAY,CAAf,EAAkB;UAChBM,UAAU,GAAGD,SAAS,CAAC3I,IAAV,CAAeqB,CAAC,IAAEA,CAAC,CAAC,CAAD,CAAD,IAAQkH,WAA1B,CAAb;UACAK,UAAU,CAAC,CAAD,CAAV,IAAiBN,KAAK,CAAC,CAAD,CAAtB;QACD;MACF,CAhE4B,CAkE7B;;;MACA,IAAIO,WAAW,GAAG,CAAlB;;MACA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAiBA,CAAC,GAAGL,aAAa,CAAC9G,MAAnC,EAA2CmH,CAAC,EAA5C,EAAiD;QAC/CD,WAAW,IAAIJ,aAAa,CAACK,CAAD,CAAb,CAAiB,CAAjB,CAAf;QACAL,aAAa,CAACK,CAAD,CAAb,CAAiB,CAAjB,IAAsBD,WAAtB;MACD;;MAED,IAAIE,WAAW,GAAG,CAAlB;;MACA,KAAK,IAAID,CAAC,GAAG,CAAb,EAAiBA,CAAC,GAAGJ,cAAc,CAAC/G,MAApC,EAA4CmH,CAAC,EAA7C,EAAkD;QAChDC,WAAW,IAAIL,cAAc,CAACI,CAAD,CAAd,CAAkB,CAAlB,CAAf;QACAJ,cAAc,CAACI,CAAD,CAAd,CAAkB,CAAlB,IAAuBC,WAAvB;MACD;;MAED,IAAIC,WAAW,GAAG,CAAlB;;MACA,KAAK,IAAIF,CAAC,GAAG,CAAb,EAAiBA,CAAC,GAAGH,SAAS,CAAChH,MAA/B,EAAuCmH,CAAC,EAAxC,EAA6C;QAC3CE,WAAW,IAAIL,SAAS,CAACG,CAAD,CAAT,CAAa,CAAb,CAAf;QACAH,SAAS,CAACG,CAAD,CAAT,CAAa,CAAb,IAAkBE,WAAlB;MACD;;MAED,KAAKrC,yBAAL,GAAiC8B,aAAjC;MACA,KAAK7B,0BAAL,GAAkC8B,cAAlC;MACA,KAAK7B,qBAAL,GAA6B8B,SAA7B;MACA,KAAK7B,kBAAL,GAA0BsB,YAA1B;MACA,KAAKa,cAAL;IAED,CA3FD,MA2FO;MACL,KAAKnD,aAAL,GAAqB,EAArB;MACA,KAAKiB,cAAL,GAAsB,CAAtB;IACD;EACF;;EAEDyB,mBAAmB,CAACF,KAAD,EAAY;IAC7B,OAAOA,KAAK,CAAClB,OAAN,GAAgB8B,QAAhB,GAA2BC,QAA3B,CAAoC,CAApC,EAAsC,GAAtC,IAA6C,GAA7C,GAAmD,CAACb,KAAK,CAACc,QAAN,KAAmB,CAApB,EAAuBF,QAAvB,GAAkCC,QAAlC,CAA2C,CAA3C,EAA6C,GAA7C,CAAnD,GAAuG,GAAvG,GAA6Gb,KAAK,CAACe,WAAN,EAApH;EACD;;EAEDvE,sBAAsB;IACpB;IACA,KAAKwE,gBAAL,GAAwB,EAAxB;IACA,KAAKC,iBAAL,GAAyB,EAAzB;IAGA,IAAIC,QAAJ;IACA,IAAIC,QAAJ;IACAD,QAAQ,GAAG,IAAIpE,IAAJ,CAAS,KAAK1C,YAAL,CAAkB0B,WAA3B,CAAX;IACAoF,QAAQ,CAACrC,OAAT,CAAiBqC,QAAQ,CAACpC,OAAT,KAAqB,CAAtC,EAToB,CAWpB;;IACA,IAAIsC,OAAO,GAAG,IAAIF,QAAQ,CAACG,MAAT,EAAlB,CAZoB,CAapB;;IACAF,QAAQ,GAAG,IAAIrE,IAAJ,CAAS,KAAK1C,YAAL,CAAkB0B,WAA3B,CAAX;IACAqF,QAAQ,CAACtC,OAAT,CAAiBsC,QAAQ,CAACrC,OAAT,MAAsB,IAAEsC,OAAxB,CAAjB;IAEA,IAAIE,GAAG,GAAG,IAAIxE,IAAJ,CAASoE,QAAQ,CAACrC,OAAT,CAAiBqC,QAAQ,CAACpC,OAAT,KAAqB,CAAtC,CAAT,CAAV;IACA,IAAIyC,GAAG,GAAG,IAAIzE,IAAJ,CAASqE,QAAQ,CAACtC,OAAT,CAAiBsC,QAAQ,CAACrC,OAAT,KAAqB,CAAtC,CAAT,CAAV;IACA,KAAKkC,gBAAL,CAAsBhC,IAAtB,CAA2BsC,GAA3B;IACA,KAAKL,iBAAL,CAAuBjC,IAAvB,CAA4BuC,GAA5B;IAEA,IAAIC,OAAO,GAAG,IAAI1E,IAAJ,CAAS,KAAK1C,YAAL,CAAkB8B,YAA3B,CAAd;IACAsF,OAAO,CAAC3C,OAAR,CAAgB2C,OAAO,CAAC1C,OAAR,KAAoB,CAApC;IACA,IAAI2C,gBAAgB,GAAG,IAAvB;;IACA,OAAMN,QAAQ,IAAIK,OAAlB,EAA0B;MACxB;MACA,IAAIF,GAAJ;;MACA,IAAGG,gBAAH,EAAqB;QACnB,IAAIC,qBAAqB,GAAG,IAAIR,QAAQ,CAACG,MAAT,EAAhC;QACAC,GAAG,GAAE,IAAIxE,IAAJ,CAASoE,QAAQ,CAACrC,OAAT,CAAiBqC,QAAQ,CAACpC,OAAT,KAAmB4C,qBAApC,CAAT,CAAL;QACAD,gBAAgB,GAAG,KAAnB;MACD,CAJD,MAIO;QACLH,GAAG,GAAE,IAAIxE,IAAJ,CAASoE,QAAQ,CAACrC,OAAT,CAAiBqC,QAAQ,CAACpC,OAAT,KAAmB,CAApC,CAAT,CAAL;MACD;;MAED,IAAIyC,GAAJ;;MACA,IAAGD,GAAG,IAAIE,OAAV,EAAmB;QACjBD,GAAG,GAAE,IAAIzE,IAAJ,CAASqE,QAAQ,CAACtC,OAAT,CAAiBsC,QAAQ,CAACrC,OAAT,KAAmB,CAApC,CAAT,CAAL;;QACA,IAAGyC,GAAG,IAAIC,OAAV,EAAmB;UACjB,KAAKR,gBAAL,CAAsBhC,IAAtB,CAA2BsC,GAA3B;UACA,KAAKL,iBAAL,CAAuBjC,IAAvB,CAA4BuC,GAA5B;QACD,CAHD,MAGO;UACL,IAAII,IAAI,GAAG,IAAI7E,IAAJ,CAASqE,QAAQ,CAACtC,OAAT,CAAiBsC,QAAQ,CAACrC,OAAT,KAAmB,CAApC,CAAT,CAAX;UACA,IAAI8C,YAAY,GAAG,IAAI9E,IAAJ,CAAS0E,OAAT,CAAnB;UACAI,YAAY,CAAC/C,OAAb,CAAqB+C,YAAY,CAAC9C,OAAb,KAAwB,CAA7C;;UACA,OAAO6C,IAAI,GAAGC,YAAd,EAA4B;YAAE;YAC5BD,IAAI,CAAC9C,OAAL,CAAa8C,IAAI,CAAC7C,OAAL,KAAiB,CAA9B;UACD;;UACD,KAAKkC,gBAAL,CAAsBhC,IAAtB,CAA2BsC,GAA3B;UACA,KAAKL,iBAAL,CAAuBjC,IAAvB,CAA4B2C,IAA5B;QACD;MACF,CAfD,MAeO;QACL;QACAR,QAAQ,CAACtC,OAAT,CAAiBsC,QAAQ,CAACrC,OAAT,KAAmB,CAApC;MACD;IACF;;IACD,KAAK+C,SAAL,GAAiB,EAAjB,CAzDoB,CA0DpB;;IAEA,KAAK,IAAIC,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAG,KAAKd,gBAAL,CAAsB3H,MAAlD,EAA0DyI,KAAK,EAA/D,EAAmE;MACjE,KAAKD,SAAL,CAAeC,KAAf,IAAwB,CAAxB;MACA,KAAKC,oBAAL,CAA0BD,KAA1B,IAAmC,CAAnC;MACA,KAAKE,aAAL,CAAmBF,KAAnB,IAA4B,CAA5B;IACD;EACF;;EAEDzE,yBAAyB;IACvB,KAAI,IAAImD,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC,KAAKpE,gBAApB,EAAsCoE,CAAC,EAAvC,EAA2C;MACzC,KAAI,IAAIyB,MAAR,IAAkB,KAAKhF,mBAAvB,EAA4C;QAC1C,IAAIiF,GAAG,GAAG,KAAKxG,cAAL,CAAoBhE,IAApB,CAAyBqB,CAAC,IAAGA,CAAC,CAACoJ,OAAF,IAAaF,MAAM,CAACE,OAAjD,CAAV;QACA,IAAIC,oBAAoB,GAAG,KAAKrF,cAAL,CAAoBlG,MAApB,CAA2BkC,CAAC,IAAKA,CAAC,CAACsJ,WAAF,IAAiB7B,CAAC,GAAC,CAAnB,IAAwBzH,CAAC,CAACS,UAAF,IAAcyI,MAAM,CAACzI,UAA9E,EAA2F8I,MAA3F,CAAkG,CAACC,GAAD,EAAMC,OAAN,KAAkBlD,MAAM,CAACiD,GAAD,CAAN,GAAcjD,MAAM,CAACkD,OAAO,CAACC,cAAT,CAAxI,EAAkK,CAAlK,CAA3B;QACA,IAAIC,gBAAgB,GAAGpD,MAAM,CAAC4C,GAAG,CAACS,cAAL,CAAN,GAA6BrD,MAAM,CAAC8C,oBAAD,CAA1D;QACA,KAAKL,oBAAL,CAA0BvB,CAA1B,KAAgClB,MAAM,CAACoD,gBAAD,CAAtC;QACA,KAAKX,oBAAL,CAA0BvB,CAA1B,IAA+BlB,MAAM,CAAC,KAAKyC,oBAAL,CAA0BvB,CAA1B,EAA6BoC,OAA7B,CAAqC,CAArC,CAAD,CAArC;MACC;IACJ;EACF;;EAEDC,YAAY,CAACrJ,UAAD,EAAasJ,aAAb,EAA0B;IACpC;IACA,IAAIC,QAAQ,GAAG,KAAKtG,QAAL,CAAc5F,MAAd,CAAqBkC,CAAC,IAAEA,CAAC,CAACS,UAAF,IAAgBA,UAAxC,CAAf;IACAuJ,QAAQ,CAACrD,IAAT,CAAc,UAASC,CAAT,EAAWC,CAAX,EAAY;MACxB,OAAOD,CAAC,CAAC9C,UAAF,CAAagD,OAAb,KAAyBD,CAAC,CAAC/C,UAAF,CAAagD,OAAb,EAAhC;IACD,CAFD;IAIA,IAAImD,UAAU,GAAGD,QAAQ,CAAC1J,MAAT,GAAkB,CAAnC;;IACA,IAAG2J,UAAU,GAAG,CAAhB,EAAmB;MACjB;MACAlL,OAAO,CAACC,GAAR,CAAY,iCAAZ;MACA,OAAO,CAAP;IACD,CAZmC,CAapC;;;IACA,IAAG+K,aAAa,IAAIC,QAAQ,CAACC,UAAD,CAAR,CAAqBnG,UAAzC,EAAqD;MACnD,OAAOkG,QAAQ,CAACC,UAAD,CAAR,CAAqBC,KAA5B;IACD,CAFD,MAEO;MACL;MACA,KAAI,IAAIzC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAEwC,UAAlB,EAA8BxC,CAAC,EAA/B,EAAmC;QACjC,IAAGsC,aAAa,IAAIC,QAAQ,CAACvC,CAAD,CAAR,CAAY3D,UAA7B,IAA2CiG,aAAa,GAAGC,QAAQ,CAACvC,CAAC,GAAC,CAAH,CAAR,CAAc3D,UAA5E,EAAwF;UACtF,OAAOkG,QAAQ,CAACvC,CAAD,CAAR,CAAYyC,KAAnB;QACD;MACF;IACF,CAvBmC,CA0BpC;;;IACAnL,OAAO,CAACC,GAAR,CAAY,yBAAZ,EAAuCyB,UAAvC,EAAmDsJ,aAAnD,EA3BoC,CA4BpC;IACA;;IACA,OAAOC,QAAQ,CAAC,CAAD,CAAR,CAAYE,KAAnB;EACD;;EAEDlF,OAAO;IACL,IAAImD,QAAJ;IACA,IAAIgC,KAAJ;IACA,IAAIC,QAAJ;IAEA,KAAKC,WAAL,GAAmB,EAAnB;;IAEA,KAAI,IAAI5C,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC,KAAKlD,mBAAL,CAAyBjE,MAAxC,EAA+CmH,CAAC,EAAhD,EAAmD;MACjDU,QAAQ,GAAG,IAAIpE,IAAJ,CAAS,KAAKQ,mBAAL,CAAyBkD,CAAzB,EAA4B6C,kBAArC,CAAX;MAEAF,QAAQ,GAAG,KAAK7F,mBAAL,CAAyBkD,CAAzB,EAA4BhH,UAAvC;MACA0J,KAAK,GAAE,KAAK5F,mBAAL,CAAyBkD,CAAzB,EAA4B8C,aAAnC;MAEA,IAAIC,SAAS,GAAG,KAAKV,YAAL,CAAkBM,QAAlB,EAA4BjC,QAA5B,CAAhB;MACA,IAAIsC,OAAO,GAAG,KAAKlG,mBAAL,CAAyBkD,CAAzB,EAA4BgD,OAA1C;MAEA,IAAIC,cAAc,GAAG,KAAKL,WAAL,CAAiB1L,IAAjB,CAAuBuK,MAAD,IAAYA,MAAM,CAAC,CAAD,CAAN,KAAckB,QAAhD,CAArB;;MAEA,IAAI,CAACM,cAAL,EAAqB;QACnB,IAAIC,sBAAsB,GAAG,KAAKC,2BAAL,EAA7B;QACA,KAAKP,WAAL,CAAiBpE,IAAjB,CAAsB,CAACmE,QAAD,EAAWO,sBAAX,EAAmCF,OAAnC,CAAtB,EAFmB,CAEiD;MACrE;;MAED,KAAKI,eAAL,CAAqB1C,QAArB,EAA8BgC,KAA9B,EAAqCK,SAArC,EAAgDJ,QAAhD;IACD;;IAED,KAAK,IAAI3C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK1C,mBAAL,CAAyBzE,MAA7C,EAAqDmH,CAAC,EAAtD,EAA0D;MACxDU,QAAQ,GAAG,IAAIpE,IAAJ,CAAS,KAAKgB,mBAAL,CAAyB0C,CAAzB,EAA4B6C,kBAArC,CAAX;MAEAF,QAAQ,GAAG,KAAKrF,mBAAL,CAAyB0C,CAAzB,EAA4BhH,UAAvC;MACA0J,KAAK,GAAG,KAAKpF,mBAAL,CAAyB0C,CAAzB,EAA4B8C,aAApC;MAEA,IAAIC,SAAS,GAAG,KAAKzF,mBAAL,CAAyB0C,CAAzB,EAA4BqD,SAA5C;MACA,IAAIL,OAAO,GAAG,KAAK1F,mBAAL,CAAyB0C,CAAzB,EAA4BgD,OAA1C;MAEA,IAAIC,cAAc,GAAG,KAAKL,WAAL,CAAiB1L,IAAjB,CAAuBuK,MAAD,IAAYA,MAAM,CAAC,CAAD,CAAN,KAAckB,QAAhD,CAArB;;MAEA,IAAI,CAACM,cAAL,EAAqB;QACnB,IAAIC,sBAAsB,GAAG,KAAKC,2BAAL,EAA7B;QACA,KAAKP,WAAL,CAAiBpE,IAAjB,CAAsB,CAACmE,QAAD,EAAWO,sBAAX,EAAmCF,OAAnC,CAAtB,EAFmB,CAEiD;MACrE;;MACD,KAAKI,eAAL,CAAqB1C,QAArB,EAA+BgC,KAA/B,EAAsCK,SAAtC,EAAiDJ,QAAjD;IACD,CA1CI,CA4CL;;;IACA,KAAI,IAAI3C,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAE,KAAKxD,mBAAL,CAAyB3D,MAAzC,EAAiDmH,CAAC,EAAlD,EAAsD;MACpD,IAAIsD,eAAe,GAAG,KAAKV,WAAL,CAAiB1L,IAAjB,CAAuBqM,UAAD,IAAgBA,UAAU,CAAC,CAAD,CAAV,IAAiB,KAAK/G,mBAAL,CAAyBwD,CAAzB,EAA4BhH,UAAnF,CAAtB;;MACA,IAAG,CAACsK,eAAJ,EAAqB;QACnB,IAAIJ,sBAAsB,GAAG,KAAKC,2BAAL,EAA7B;QACA,KAAKP,WAAL,CAAiBpE,IAAjB,CAAsB,CAACmE,QAAD,EAAWO,sBAAX,EAAmC,KAAK1G,mBAAL,CAAyBwD,CAAzB,EAA4BgD,OAA/D,CAAtB,EAFmB,CAE6E;MACjG;IACF;EACF;;EAGDG,2BAA2B;IACzB,IAAID,sBAAsB,GAAG,EAA7B;;IACA,KAAK,IAAI5B,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAG,KAAKd,gBAAL,CAAsB3H,MAAlD,EAA0DyI,KAAK,EAA/D,EAAmE;MACjE4B,sBAAsB,CAAC5B,KAAD,CAAtB,GAAgC,CAAhC;IACD;;IACD,OAAO4B,sBAAP;EACD;;EAEDE,eAAe,CAAC1C,QAAD,EAAUgC,KAAV,EAAgBK,SAAhB,EAA2BJ,QAA3B,EAAmC;IAChD,IAAIa,gBAAgB,GAAG,CAAC,CAAxB;;IACA,KAAI,IAAIxD,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC,KAAKS,iBAAL,CAAuB5H,MAAtC,EAA6CmH,CAAC,EAA9C,EAAiD;MAC/C,IAAGU,QAAQ,IAAG,KAAKF,gBAAL,CAAsBR,CAAtB,CAAX,IAAuCU,QAAQ,IAAE,KAAKD,iBAAL,CAAuBT,CAAvB,CAApD,EAA8E;QAC5EwD,gBAAgB,GAAGxD,CAAnB;QACA;MACD;IACF;;IAED,IAAGwD,gBAAgB,IAAI,CAAC,CAAxB,EAA2B;MACzB;IACD;;IAED,KAAKnC,SAAL,CAAemC,gBAAf,KAAoCd,KAApC;IACA,KAAKlB,aAAL,CAAmBgC,gBAAnB,KAAwC1E,MAAM,CAAC4D,KAAK,GAACK,SAAP,CAA9C;IACA,KAAKvB,aAAL,CAAmBgC,gBAAnB,IAAuC1E,MAAM,CAAC,KAAK0C,aAAL,CAAmBgC,gBAAnB,EAAqCpB,OAArC,CAA6C,CAA7C,CAAD,CAA7C,CAfgD,CAiBhD;;IACA,KAAKQ,WAAL,CAAiB1L,IAAjB,CAAuBuK,MAAD,IAAYA,MAAM,CAAC,CAAD,CAAN,KAAckB,QAAhD,EAA0D,CAA1D,EAA6Da,gBAA7D,KAAkFd,KAAlF;EACD;;EAEDlF,iBAAiB;IACf,IAAI8E,aAAJ;IACA,IAAII,KAAJ;IACA,KAAKK,SAAL,GAAiB,CAAjB;;IAEA,KAAI,IAAI/C,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAC,KAAKlD,mBAAL,CAAyBjE,MAAxC,EAA+CmH,CAAC,EAAhD,EAAmD;MACjDsC,aAAa,GAAG,IAAIhG,IAAJ,CAAS,KAAKQ,mBAAL,CAAyBkD,CAAzB,EAA4B6C,kBAArC,CAAhB;MACAP,aAAa,CAACjE,OAAd,CAAsBiE,aAAa,CAAChE,OAAd,KAA0B,CAAhD;MAEA,IAAImF,mBAAmB,GAAG,KAAKpB,YAAL,CAAkB,KAAKvF,mBAAL,CAAyBkD,CAAzB,EAA4BhH,UAA9C,EAA0DsJ,aAA1D,CAA1B;MACAI,KAAK,GAAG,KAAK5F,mBAAL,CAAyBkD,CAAzB,EAA4B8C,aAApC;MACA,KAAKC,SAAL,IAAmBjE,MAAM,CAAC2E,mBAAD,CAAN,GAA8B3E,MAAM,CAAC4D,KAAD,CAAvD;IACD;;IAED,KAAI,IAAI1C,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAE,KAAK1C,mBAAL,CAAyBzE,MAA3C,EAAmDmH,CAAC,EAApD,EAAwD;MACtD0C,KAAK,GAAE,KAAKpF,mBAAL,CAAyB0C,CAAzB,EAA4B8C,aAAnC;MACA,IAAIC,SAAS,GAAG,KAAKzF,mBAAL,CAAyB0C,CAAzB,EAA4BqD,SAA5C;MACA,KAAKN,SAAL,IAAmBjE,MAAM,CAACiE,SAAD,CAAN,GAAoBjE,MAAM,CAAC4D,KAAD,CAA7C;IACD;EACF;;EAEDgB,gBAAgB,CAACC,SAAD,EAAkB;IAChC,IAAIC,KAAK,GAAG,KAAKrH,cAAL,CAAoBlG,MAApB,CAA2BkC,CAAC,IAAIA,CAAC,CAACS,UAAF,IAAgB2K,SAAhD,CAAZ;IACA,OAAOC,KAAK,CAACC,KAAN,CAAY,CAAZ,EAAe,KAAKjI,gBAApB,CAAP;EACD;;EAEDM,YAAY,CAAC4H,OAAD,EAAgB;IAC1BhQ,IAAI,CAACqF,IAAL,CAAU,OAAV,EAAmB2K,OAAnB,EAA4B,MAA5B;EACD;;EAEDzG,cAAc;IACZ,KAAK0G,QAAL,CAAczK,IAAd,CAAmB0K,QAAnB,GAA8B,EAA9B;IAGA,KAAKC,0BAAL,GAAkC,CAAlC;IACA,KAAKC,gCAAL,GAAwC,CAAxC;IACA,KAAKC,6BAAL,GAAqC,CAArC;IACA,KAAKC,8BAAL,GAAsC,CAAtC;IACA,KAAKC,wBAAL,GAAgC,KAAKlH,kBAAL,CAAwBtE,MAAxD;;IAGA,KAAK,IAAImH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK7C,kBAAL,CAAwBtE,MAA5C,EAAoDmH,CAAC,EAArD,EAAyD;MAEvD,MAAMsE,KAAK,GAAG,KAAKnH,kBAAL,CAAwB6C,CAAxB,CAAd;MAEA,IAAIuE,KAAJ;;MACA,IAAGD,KAAK,CAAC3G,IAAN,IAAc2G,KAAK,CAACE,WAAvB,EAAoC;QAClCD,KAAK,GAAG,SAAR;QACAD,KAAK,CAACE,WAAN,IAAqB,GAArB,GAA0B,KAAKL,6BAAL,IAAsC,CAAhE,GAAoE,KAAKF,0BAAL,IAAmC,CAAvG;MACD,CAHD,MAGO;QACL,KAAKC,gCAAL,IAAyC,CAAzC;QACAK,KAAK,GAAG,SAAR;MACD;;MAED,IAAIE,OAAO,GAAG;QACZC,KAAK,EAAEJ,KAAK,CAACK,IADD;QAEZrL,IAAI,EAAE,CAAC;UAACf,CAAC,EAAE+L,KAAK,CAACE,WAAV;UAAuBI,CAAC,EAAEN,KAAK,CAAC3G;QAAhC,CAAD,CAFM;QAGZkH,WAAW,EAAE,CAHD;QAIZC,eAAe,EAAE,CAACP,KAAD,CAJL;QAKZQ,WAAW,EAAE;MALD,CAAd;MAQA,KAAKhB,QAAL,CAAczK,IAAd,CAAmB0K,QAAnB,CAA4BxF,IAA5B,CAAiCiG,OAAjC;IAED;;IACD,KAAKV,QAAL,CAAciB,MAAd;EAED;;EAED7E,cAAc;IACZ,KAAK8E,QAAL,CAAc3L,IAAd,CAAmB4L,MAAnB,GAA4B,KAAKlH,kBAAjC;IAEA,KAAKiH,QAAL,CAAc3L,IAAd,CAAmB0K,QAAnB,GAA8B,EAA9B;IACA,KAAKiB,QAAL,CAAc3L,IAAd,CAAmB0K,QAAnB,CAA4BxF,IAA5B,CAAiC;MAC/BkG,KAAK,EAAE,UADwB;MAE/BpL,IAAI,EAAE,KAAKuE,yBAFoB;MAG/BgH,WAAW,EAAE;IAHkB,CAAjC;IAKA,KAAKI,QAAL,CAAc3L,IAAd,CAAmB0K,QAAnB,CAA4BxF,IAA5B,CAAiC;MAC/BkG,KAAK,EAAE,MADwB;MAE/BpL,IAAI,EAAE,KAAKyE,qBAFoB;MAG/B8G,WAAW,EAAE;IAHkB,CAAjC;IAKA,KAAKI,QAAL,CAAc3L,IAAd,CAAmB0K,QAAnB,CAA4BxF,IAA5B,CAAiC;MAC/BkG,KAAK,EAAE,WADwB;MAE/BpL,IAAI,EAAE,KAAKwE,0BAFoB;MAG/B+G,WAAW,EAAE;IAHkB,CAAjC;IAKA,KAAKI,QAAL,CAAcD,MAAd;EACD;;EAEDvH,kBAAkB;IAChB,KAAK0H,QAAL,CAAc7L,IAAd,CAAmB4L,MAAnB,GAA4B,EAA5B;IACA,KAAKC,QAAL,CAAc7L,IAAd,CAAmB0K,QAAnB,CAA4B,CAA5B,EAA+B1K,IAA/B,GAAsC,EAAtC;IACA,KAAK6L,QAAL,CAAc7L,IAAd,CAAmB0K,QAAnB,CAA4B,CAA5B,EAA+B1K,IAA/B,GAAsC,EAAtC;IAEA,KAAK6L,QAAL,CAAc7L,IAAd,CAAmB4L,MAAnB,CAA0B1G,IAA1B,CAA+B,UAA/B;IACA,KAAK2G,QAAL,CAAc7L,IAAd,CAAmB0K,QAAnB,CAA4B,CAA5B,EAA+B1K,IAA/B,CAAoCkF,IAApC,CAAyC,KAAK1E,YAAL,CAAkBsL,gBAA3D;IACA,KAAKD,QAAL,CAAc7L,IAAd,CAAmB0K,QAAnB,CAA4B,CAA5B,EAA+B1K,IAA/B,CAAoCkF,IAApC,CAAyC,KAAKP,cAA9C;IAEA,KAAKkH,QAAL,CAAc7L,IAAd,CAAmB4L,MAAnB,CAA0B1G,IAA1B,CAA+B,QAA/B;IACA,KAAK2G,QAAL,CAAc7L,IAAd,CAAmB0K,QAAnB,CAA4B,CAA5B,EAA+B1K,IAA/B,CAAoCkF,IAApC,CAAyC,KAAK1E,YAAL,CAAkBuL,iBAAlB,GAAsC,KAAKvL,YAAL,CAAkBwL,oBAAjG;IACA,KAAKH,QAAL,CAAc7L,IAAd,CAAmB0K,QAAnB,CAA4B,CAA5B,EAA+B1K,IAA/B,CAAoCkF,IAApC,CAAyC,KAAKuE,SAA9C;IAEA,KAAKoC,QAAL,CAAc7L,IAAd,CAAmB4L,MAAnB,CAA0B1G,IAA1B,CAA+B,UAA/B;IACA,KAAK2G,QAAL,CAAc7L,IAAd,CAAmB0K,QAAnB,CAA4B,CAA5B,EAA+B1K,IAA/B,CAAoCkF,IAApC,CAAyC,KAAK1E,YAAL,CAAkByL,iBAA3D;IACA,KAAKJ,QAAL,CAAc7L,IAAd,CAAmB0K,QAAnB,CAA4B,CAA5B,EAA+B1K,IAA/B,CAAoCkF,IAApC,CAA0C,KAAKP,cAAL,GAAsB,KAAK8E,SAArE;IAEA,KAAKoC,QAAL,CAAcH,MAAd;EACD;;EAEDzP,WAAW;IACT,KAAK4P,QAAL,GAAgB,IAAIlR,KAAJ,CAAU,WAAV,EAAuB;MACrCuR,IAAI,EAAE,KAD+B;MAErClM,IAAI,EAAE;QACJ4L,MAAM,EAAE,EADJ;QAEJlB,QAAQ,EAAE,CACR;UACEU,KAAK,EAAE,UADT;UAEEpL,IAAI,EAAE,EAFR;UAGEuL,WAAW,EAAE,CAHf;UAIEC,eAAe,EAAE,CAAC,SAAD;QAJnB,CADQ,EAOR;UACEJ,KAAK,EAAE,MADT;UAEEpL,IAAI,EAAE,EAFR;UAGEuL,WAAW,EAAE,CAHf;UAIEC,eAAe,EAAE,CAAC,SAAD;QAJnB,CAPQ;MAFN,CAF+B;MAmBrCW,OAAO,EAAE;QACPC,UAAU,EAAE,IADL;QAEPC,mBAAmB,EAAE,KAFd;QAGPC,MAAM,EAAE;UACNhB,CAAC,EAAE;YACDiB,WAAW,EAAE,IADZ;YAED;YACA;YACAC,KAAK,EAAE;cACLC,QAAQ,EAAE,UAAS9K,KAAT,EAAgBqG,KAAhB,EAAuBwE,KAAvB,EAA4B;gBACpC,OAAO,QAAQhH,MAAM,CAAC7D,KAAD,CAAN,CAAcmH,OAAd,CAAsB,CAAtB,CAAf;cACD;YAHI;UAJN;QADG,CAHD;QAeP4B,QAAQ,EAAE;UACRgC,GAAG,EAAE;YACHC,aAAa,EAAE;UADZ;QADG,CAfH;QAoBPC,OAAO,EAAE;UACP7M,KAAK,EAAE;YACL8M,OAAO,EAAE,IADJ;YAELC,IAAI,EAAE;UAFD,CADA;UAKPC,MAAM,EAAE;YACNC,QAAQ,EAAE;UADJ,CALD;UAQPC,OAAO,EAAE;YACPC,SAAS,EAAE;cACT9B,KAAK,EAAE,UAAS+B,OAAT,EAAgB;gBACrB,IAAI/B,KAAK,GAAG+B,OAAO,CAACC,OAAR,CAAgBhC,KAAhB,IAAyB,EAArC;;gBAEA,IAAIA,KAAJ,EAAW;kBACPA,KAAK,IAAI,IAAT;gBACH;;gBACD,IAAI+B,OAAO,CAACE,MAAR,CAAe/B,CAAf,KAAqB,IAAzB,EAA+B;kBAC3BF,KAAK,IAAI,QAAS+B,OAAO,CAACE,MAAR,CAAe/B,CAAf,CAAiBxC,OAAjB,CAAyB,CAAzB,CAAlB;gBACH;;gBACD,OAAOsC,KAAP;cACD;YAXQ;UADJ,CARF;UAuBPkC,UAAU,EAAE;YACVC,MAAM,EAAE,QADE;YAEVC,KAAK,EAAE,QAFG;YAGVC,IAAI,EAAE;cACJC,MAAM,EAAE;YADJ,CAHI;YAMVzC,KAAK,EAAE,MANG;YAOV0C,SAAS,EAAE,UAAShM,KAAT,EAAgBwL,OAAhB,EAAuB;cAChC,OAAO,QAAQ3H,MAAM,CAAC7D,KAAD,CAAN,CAAcmH,OAAd,CAAsB,CAAtB,CAAf;YACD;UATS;QAvBL;MApBF;IAnB4B,CAAvB,CAAhB;IA6EA,KAAK2B,QAAL,GAAgB,IAAI9P,KAAJ,CAAU,aAAV,EAAyB;MACvCuR,IAAI,EAAE,SADiC;MAEvClM,IAAI,EAAE;QACJ0K,QAAQ,EAAE;MADN,CAFiC;MAKvCyB,OAAO,EAAE;QACPC,UAAU,EAAE,IADL;QAEPC,mBAAmB,EAAE,KAFd;QAGPC,MAAM,EAAE;UACNrN,CAAC,EAAE;YACDiN,IAAI,EAAE,QADL;YAEDc,QAAQ,EAAE,QAFT;YAGDY,GAAG,EAAE,CAHJ;YAIDC,GAAG,EAAE,GAJJ;YAKD9N,KAAK,EAAE;cACL8M,OAAO,EAAE,IADJ;cAELC,IAAI,EAAE;YAFD,CALN;YASDN,KAAK,EAAE;cACLC,QAAQ,EAAE,UAAU9K,KAAV,EAAiBqG,KAAjB,EAAwBwE,KAAxB,EAA6B;gBACrC,OAAOhH,MAAM,CAAC7D,KAAD,CAAN,CAAcmH,OAAd,CAAsB,CAAtB,IAA2B,GAAlC;cACD;YAHI;UATN,CADG;UAgBNwC,CAAC,EAAE;YACDY,IAAI,EAAE,QADL;YAEDc,QAAQ,EAAE,MAFT;YAGDY,GAAG,EAAE,CAHJ;YAIDC,GAAG,EAAE,GAJJ;YAKD9N,KAAK,EAAE;cACL8M,OAAO,EAAE,IADJ;cAELC,IAAI,EAAE;YAFD,CALN;YASDN,KAAK,EAAE;cACLC,QAAQ,EAAE,UAAU9K,KAAV,EAAiBqG,KAAjB,EAAwBwE,KAAxB,EAA6B;gBACrC,OAAOhH,MAAM,CAAC7D,KAAD,CAAN,CAAcmH,OAAd,CAAsB,CAAtB,IAA2B,GAAlC;cACD;YAHI;UATN;QAhBG,CAHD;QAmCP8D,OAAO,EAAE;UACP7M,KAAK,EAAE;YACL8M,OAAO,EAAE,IADJ;YAELC,IAAI,EAAE;UAFD,CADA;UAKPC,MAAM,EAAE;YACNF,OAAO,EAAE;UADH,CALD;UAQPI,OAAO,EAAE;YACPC,SAAS,EAAE;cACT9B,KAAK,EAAE,UAAU+B,OAAV,EAAiB;gBACtB,IAAI/B,KAAK,GAAG+B,OAAO,CAACC,OAAR,CAAgBhC,KAAhB,IAAyB,EAArC;;gBAEA,IAAIA,KAAJ,EAAW;kBACTA,KAAK,IAAI,IAAT;gBACD;;gBACD,IAAI+B,OAAO,CAACE,MAAR,CAAepO,CAAf,KAAqB,IAArB,IAA6BkO,OAAO,CAACE,MAAR,CAAe/B,CAAf,KAAqB,IAAtD,EAA4D;kBAC1D,MAAMJ,WAAW,GAAGiC,OAAO,CAACE,MAAR,CAAepO,CAAnC;kBACA,MAAMoF,IAAI,GAAG8I,OAAO,CAACE,MAAR,CAAe/B,CAA5B;kBAEAF,KAAK,IAAI,kBAAkBF,WAAW,CAACpC,OAAZ,CAAoB,CAApB,CAAlB,GAA2C,WAA3C,GAAyDzE,IAAI,CAACyE,OAAL,CAAa,CAAb,CAAzD,GAA2E,GAApF;gBACD;;gBACD,OAAOsC,KAAP;cACD;YAdQ;UADJ;QARF;MAnCF;IAL8B,CAAzB,CAAhB;IAuEA,KAAKO,QAAL,GAAgB,IAAIhR,KAAJ,CAAU,YAAV,EAAwB;MACtCuR,IAAI,EAAE,MADgC;MAEtClM,IAAI,EAAE;QACJ4L,MAAM,EAAE,CAAC,UAAD,EAAa,UAAb,EAAyB,WAAzB,CADJ;QAEJlB,QAAQ,EAAE,CACR;UACEU,KAAK,EAAE,MADT;UAEEpL,IAAI,EAAE,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb;QAFR,CADQ,EAKR;UACEoL,KAAK,EAAE,UADT;UAEEpL,IAAI,EAAE,CAAC,IAAD,EAAO,IAAP,EAAY,IAAZ;QAFR,CALQ;MAFN,CAFgC;MAetCmM,OAAO,EAAE;QACPC,UAAU,EAAE,IADL;QAEPC,mBAAmB,EAAE,KAFd;QAGPO,OAAO,EAAE;UACPG,MAAM,EAAE;YACNC,QAAQ,EAAE;UADJ,CADD;UAIPjN,KAAK,EAAE;YACL8M,OAAO,EAAE,IADJ;YAELC,IAAI,EAAE;UAFD;QAJA,CAHF;QAYPgB,QAAQ,EAAE;UACRC,IAAI,EAAE;YACJvC,eAAe,EAAE,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,CADb;YAEJwC,WAAW,EAAE,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB;UAFT;QADE;MAZH;IAf6B,CAAxB,CAAhB;EAmCD;;EAEDC,iBAAiB,CAAC1F,WAAD,EAAY;IAC3B,IAAI2F,MAAM,GAAG,KAAKjG,oBAAL,CAA0BM,WAA1B,CAAb;IACA,IAAI4F,OAAO,GAAG,KAAKjG,aAAL,CAAmBK,WAAnB,CAAd;IACA,OAAO2F,MAAM,IAAIC,OAAV,GAAmB,OAAnB,GAA4B,KAAnC;EACD;;EAEDC,uBAAuB,CAAC7F,WAAD,EAAY;IACjC,IAAI2F,MAAM,GAAG,KAAKjG,oBAAL,CAA0BM,WAA1B,CAAb;IACA,IAAI4F,OAAO,GAAG,KAAKjG,aAAL,CAAmBK,WAAnB,CAAd;IACA,OAAO,CAAC2F,MAAM,GAAGC,OAAV,EAAmBrF,OAAnB,CAA2B,CAA3B,CAAP;EACD;;EAEDuF,aAAa;IACX,MAAMC,GAAG,GAAG,IAAI1T,KAAJ,EAAZ,CADW,CAGX;;IACA,MAAMkI,OAAO,GAAGyL,QAAQ,CAACC,cAAT,CAAwB,UAAxB,CAAhB,CAJW,CAMX;;IACA3T,WAAW,CAACiI,OAAD,CAAX,CAAqBpB,IAArB,CAA2B+M,MAAD,IAAW;MACnC,MAAMC,SAAS,GAAGD,MAAM,CAACE,SAAP,CAAiB,WAAjB,CAAlB,CADmC,CAGnC;;MACAL,GAAG,CAACM,QAAJ,CAAaF,SAAb,EAAwB,KAAxB,EAA+B,EAA/B,EAAmC,EAAnC,EAAuC,GAAvC,EAA4C,CAA5C,EAJmC,CAMnC;;MACAJ,GAAG,CAACO,IAAJ,CAAS,WAAT;IACD,CARD;EASD;;AAr/BuC;;;mBAA7B9T,+BAA6BD;AAAA;;;QAA7BC;EAA6B+T;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MC1B1CpU,+BAA0C,CAA1C,EAA0C,KAA1C,EAA0C,CAA1C,EAA0C,CAA1C,EAA0C,KAA1C,EAA0C,CAA1C,EAA0C,CAA1C,EAA0C,KAA1C,EAA0C,CAA1C,EAA0C,CAA1C,EAA0C,IAA1C,EAA0C,CAA1C;MAKiDA;MAASA;MAC1CA,+BAAiC,CAAjC,EAAiC,KAAjC,EAAiC,CAAjC,EAAiC,CAAjC,EAAiC,IAAjC,EAAiC,CAAjC,EAAiC,CAAjC,EAAiC,IAAjC,EAAiC,CAAjC,EAAiC,EAAjC,EAAiC,GAAjC,EAAiC,CAAjC;MAGuEA;MAAMA;MAEjEA,+BAA4B,EAA5B,EAA4B,GAA5B,EAA4B,EAA5B;MAAsEA;MAAgBA;MAEtFA;MAAmCA;MACnCA;MAOpBA,iCAAwC,EAAxC,EAAwC,KAAxC,EAAwC,EAAxC,EAAwC,EAAxC,EAAwC,KAAxC,EAAwC,EAAxC,EAAwC,EAAxC,EAAwC,KAAxC,EAAwC,EAAxC,EAAwC,EAAxC,EAAwC,KAAxC,EAAwC,EAAxC,EAAwC,EAAxC,EAAwC,IAAxC,EAAwC,EAAxC;MAK4CA;MAAQA;MAChCA;MAAmCA;MAA8CA;MAGrFA,iCAAwC,EAAxC,EAAwC,KAAxC,EAAwC,EAAxC,EAAwC,EAAxC,EAAwC,KAAxC,EAAwC,EAAxC,EAAwC,EAAxC,EAAwC,KAAxC,EAAwC,EAAxC,EAAwC,EAAxC,EAAwC,OAAxC;MAIwBA;MAAgBA;MACxBA,4CAAqC,EAArC,EAAqC,OAArC,EAAqC,EAArC;MAEQA;QAAA;MAAA,GAAuC,QAAvC,EAAuC;QAAA,OAC7BqU,0BAD6B;MACP,CADhC;MADJrU;MAGAA;MACIA;QAAA,OAAkBqU,0BAAlB;MAAwC,CAAxC;MACArU;;MAIJA;MAIRA,iCAA2C,EAA3C,EAA2C,OAA3C;MACYA;MAAgBA;MACxBA,4CAAqC,EAArC,EAAqC,OAArC,EAAqC,EAArC;MAEkCA;QAAA;MAAA,GAAiC,QAAjC,EAAiC;QAAA,OACjDqU,0BADiD;MAC3B,CADN;MAD9BrU;MAGAA;MACIA;QAAA,OAAkBqU,0BAAlB;MAAwC,CAAxC;MACArU;;MAIJA;MAIRA,iCAA2C,EAA3C,EAA2C,OAA3C;MACYA;MAAOA;MACfA;MACIA;QAAA;MAAA,GAAsC,QAAtC,EAAsC;QAAA,OAAWqU,kBAAX;MAAyB,CAA/D;MACArU;MAAkBA;MAAgBA;MAClCA;MAEJA;MAGJA,iCAAgC,EAAhC,EAAgC,KAAhC,EAAgC,EAAhC,EAAgC,EAAhC,EAAgC,QAAhC,EAAgC,EAAhC;MAGYA;QAAA,OAASqU,YAAT;MAAiB,CAAjB;MACArU;MAA4BA;MAChCA;MAIRA,iCAAgC,EAAhC,EAAgC,KAAhC,EAAgC,EAAhC,EAAgC,EAAhC,EAAgC,QAAhC,EAAgC,EAAhC;MAE8BA;QAAA,OAASqU,mBAAT;MAAwB,CAAxB;MAElBrU;MAEAA;MACJA;MAUhCA,iCAAkG,EAAlG,EAAkG,KAAlG,EAAkG,EAAlG,EAAkG,EAAlG,EAAkG,KAAlG,EAAkG,EAAlG,EAAkG,EAAlG,EAAkG,KAAlG,EAAkG,EAAlG,EAAkG,EAAlG,EAAkG,OAAlG,EAAkG,EAAlG,EAAkG,EAAlG,EAAkG,OAAlG,EAAkG,EAAlG,EAAkG,IAAlG,EAAkG,EAAlG,EAAkG,IAAlG,EAAkG,EAAlG;MAQqFA;MACzDA;MACAA;MAOJA;MAEJA,+BAAO,EAAP,EAAO,IAAP,EAAO,EAAP,EAAO,IAAP,EAAO,EAAP;MAGQA;MACAA;MAAMA;MAAmCA;MAEzCA;MAIJA;MACAA,4BAAI,EAAJ,EAAI,IAAJ,EAAI,EAAJ;MAEIA;MACAA;MAAMA;MAAiCA;MAEvCA;MAIJA;MACAA,4BAAI,EAAJ,EAAI,IAAJ,EAAI,EAAJ;MAEQA;MACJA;MACAA;MAIJA;MAEAA,4BAAI,EAAJ,EAAI,IAAJ,EAAI,EAAJ;MAC6DA;MAAkBA;MACvEA;MAMRA;MAOpBA;MACAA,iCAAwB,EAAxB,EAAwB,KAAxB,EAAwB,EAAxB,EAAwB,EAAxB,EAAwB,KAAxB,EAAwB,EAAxB,EAAwB,EAAxB,EAAwB,OAAxB,EAAwB,EAAxB,EAAwB,GAAxB,EAAwB,OAAxB,EAAwB,GAAxB,EAAwB,IAAxB,EAAwB,GAAxB,EAAwB,IAAxB,EAAwB,EAAxB;MAOiFA;MACzDA;MACAA;MAOJA;MAEJA,gCAAO,GAAP,EAAO,IAAP,EAAO,GAAP,EAAO,IAAP,EAAO,EAAP;MAEsFA;MAAWA;MAE7FA;MAMAA;MAA8EA;MAAIA;MAClFA;MAMJA;MAMhBA;MACAA,kCAAuB,GAAvB,EAAuB,KAAvB,EAAuB,EAAvB;MAEMA;MAEFA;MAEJA;MACAA,kCAAuB,GAAvB,EAAuB,KAAvB,EAAuB,EAAvB;MAEQA;MACJA;MACAA;MAEAA,kCAAqD,GAArD,EAAqD,OAArD,EAAqD,EAArD,EAAqD,GAArD,EAAqD,OAArD,EAAqD,GAArD,EAAqD,IAArD,EAAqD,GAArD,EAAqD,IAArD,EAAqD,EAArD;MAMoBA;MACJA;MACAA;MACIA;MACJA;MACAA;MACIA;MACJA;MACAA;MACIA;MACJA;MAGRA,gCAAO,GAAP,EAAO,IAAP,EAAO,EAAP;MACmCA;MAA4BA;MAC3DA;MAA+BA;MAAiCA;MAChEA;MAA+BA;MAA8BA;MAC7DA;MAA+BA;MAAoCA;MAMnFA;MACCA,kCAAuB,GAAvB,EAAuB,KAAvB,EAAuB,EAAvB;MAEOA;MACJA;MAOpBA,0CACwB,GADxB,EACwB,GADxB,EACwB,EADxB;MAE4BA;MAAaA;;;;;;;;MAnQQA;MAAAA;MAMiDA;MAAAA;MAEnCA;MAAAA;MAuB6BA;MAAAA,4CAAyB,SAAzB,EAAyBqU,6BAAzB,EAAyB,iBAAzB,EAAyBC,GAAzB;MAKbtU;MAAAA;MAWaA;MAAAA,6CAA0B,iBAA1B,EAA0BuU,GAA1B,EAA0B,SAA1B,EAA0BF,uBAA1B;MAKbrU;MAAAA;MAWnCA;MAAAA;MAEyBA;MAAAA;MA+BpDA;MAAAA;MAU4CA;MAAAA;MAeAA;MAAAA;MAUAA;MAAAA;MASAA;MAAAA;MAQIA;MAAAA;MAuBJA;MAAAA;MAWjBA;MAAAA;MAEaA;MAAAA;MAMjBA;MAAAA;MACiBA;MAAAA;MA8CMA;MAAAA;MACAA;MAAAA;MACAA;MAAAA;MACAA;MAAAA;MAkB3DA;MAAAA","names":["FilterProjectAssigned","FormControl","lastValueFrom","map","startWith","User","Swal","ProjectStep2","ProjectStep5","Chart","jsPDF","html2canvas","i0","ReporteExportablePdfComponent","constructor","mastertableService","spinner","projectTypeService","projectService","servicePerson","Map","filterProject","pagination","ItemsPerPage","itemsPerPage","TotalItems","totalItems","CurrentPage","currentPage","ngOnInit","showData","RenderChart","sessionStorage","getItem","user","JSON","parse","getState","getProjectTypeDropDown","getProyectos","codigoProyecto","myControl","valueChanges","pipe","val","filter","nombreProyecto","myControll","filter2","listProjectFilter","project","scodproject","toLowerCase","indexOf","snameproject","changeNombreServicio","proyecto","projectList","find","inputNombreServicio","undefined","changeCodigoServicio","console","log","changeEstado","nid_status","cadena","listState","stado","nid_mastertable_type","sshort_value","toUpperCase","sstatusname","setValue","fisrtChange","show","getmastertable","subscribe","response","x","hide","error","getDropdownlist","nid_project_type","ProjectTypeDropDownList","length","nid_manager","permisoAdministrador","nid_person","getassignedprojectpagination","res","fire","icon","title","data","e","search","esperarRespuesta","projectStep3","getprojectdtep3","projectStep2","getprojectdtep2","projectStep5","getprojectdtep5","facturacionProyecto","getprojectinvoicing","costoIntegrantes","getPersonCostByScodproject","horasEstimadas","getprojectweekperson","personalEstimado","getprojectestimate","horasRegistradas","getprojecthourslog","registrosAvanceProject","getprojectprogress","horasRegistradasExt","getprojecthoursext","Promise","all","then","value","listInvestment","ncurrency","simbMoneda","date1String","dbegin_date","substring","dateMin","date2String","dfinish_date","dateMax","ncantidadsemanas","nweeks","arrayNumberWeek","Array","generateArregloSemanas","listCost","mensajeError","forEach","element","dcost_date","Date","ListWeekPerson","listProjectPersonal","listProjectEstimate","isAuxiliary","listProjectEstimateAuxiliary","ls","calculateCostoPlanificado","listProjectHoursLog","sstate","listInvoicing","calculoFacturacion","listprogress","listAvanceProyecto","listProgressDetail","llenarGrafico2","listProjectHoursExt","calculo","calcularCostoReal","llenarNuevoGrafico","esperado","real","facturado","facturacion_montoesperado","facturacion_montofacturado","facturacion_montoreal","facturacion_labels","ingresosReales","invo","date_esperado","dplanned_date","setDate","getDate","setHours","push","namount","binvoiced","date_facturado","dbilling_date","bpaid","Number","date_real","dinvoice_payment_date","allDates","sort","a","b","getTime","fechasUnicas","fechaAnterior","fecha","fechaString","convertDatetoString","montoEsperado","montoFacturado","montoReal","encontrado","suma_valor1","i","suma_valor2","suma_valor3","llenarGrafico3","toString","padStart","getMonth","getFullYear","listSemanasStart","listSemanasFinish","fechaIni","fechaFin","dateuno","getDay","abc","abd","newDate","primeraIteracion","sumarPrimeraIteracion","abd2","ultimaSemana","listhoras","index","listCostoPlanificado","listCostoReal","person","rol","nid_rol","hora_estimada_semana","nweeknumber","reduce","sum","current","nhours_asigned","costoPlanificado","ncost_per_hour","toFixed","getCostoReal","fechaRegistro","histCost","ultima_pos","ncost","horas","personId","personHours","dregistration_date","nnumber_hours","costoReal","sperson","existingPerson","newArrayHoursForPerson","createArraySemanasWithCeros","PerteneceSemana","costohora","existingPerson2","personHour","semana_pertenece","costoRealIntegrante","FilterPersonWeek","nidperson","lista","slice","message","grafico2","datasets","cumplimiento_tareasATiempo","cumplimiento_tareasFueraDeTiempo","cumplimiento_tareasTerminadas","cumplimiento_avanceDelProyecto","cumplimiento_totalTareas","tarea","color","planificado","newData","label","name","y","borderWidth","backgroundColor","pointRadius","update","grafico3","labels","grafico1","nexpected_income","ntotal_investment","ntotal_external_cost","nexpected_utility","type","options","responsive","maintainAspectRatio","scales","beginAtZero","ticks","callback","bar","barPercentage","plugins","display","text","legend","position","tooltip","callbacks","context","dataset","parsed","datalabels","anchor","align","font","weight","formatter","min","max","elements","line","borderColor","indicadorSemaforo","numero","numero2","indicadorSemaforoNumber","downloadAsPDF","pdf","document","getElementById","canvas","imageData","toDataURL","addImage","save","selectors","decls","vars","consts","template","ctx","_r0","_r2"],"sourceRoot":"","sources":["C:\\Users\\Usuario\\Documents\\Work\\sgp\\GestionDeProyectos.2023.DEV\\MigracionAngular14\\src\\app\\layout\\manage\\components\\reporte-exportable-pdf\\reporte-exportable-pdf.component.ts","C:\\Users\\Usuario\\Documents\\Work\\sgp\\GestionDeProyectos.2023.DEV\\MigracionAngular14\\src\\app\\layout\\manage\\components\\reporte-exportable-pdf\\reporte-exportable-pdf.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { FilterProjectAssigned } from '../../model/project/filterproject';\r\nimport { FormControl } from '@angular/forms';\r\nimport { Observable, lastValueFrom, map, startWith } from 'rxjs';\r\nimport { MasterTable } from '../../model/common/mastertable';\r\nimport { MastertableService } from '../../services/common/mastertable.service';\r\nimport { NgxSpinnerService } from 'ngx-spinner';\r\nimport { DropDownList } from '../../model/dropdownlist/DropDownList';\r\nimport { ProjectTypeService } from '../../services/project/projecttype.service';\r\nimport { User } from '../../model/user/user';\r\nimport { ProjectService } from '../../services/project/project.service';\r\nimport Swal from 'sweetalert2';\r\nimport { Progress, ProgressDetail, ProjectEstimate, ProjectInvoicing, ProjectStep2, ProjectStep3Investment, ProjectStep5, WeekAvance, WeeksProjectPerson } from '../../model/project/project';\r\nimport { PersonService } from '../../services/person/person.service';\r\nimport { PersonCostHist } from '../../model/person/person.model';\r\nimport { Chart } from 'chart.js/auto';\r\nimport 'chartjs-plugin-datalabels';\r\n\r\nimport * as jsPDF from 'jspdf';\r\nimport html2canvas from 'html2canvas';\r\n\r\n@Component({\r\n  selector: 'app-reporte-exportable-pdf',\r\n  templateUrl: './reporte-exportable-pdf.component.html',\r\n  styleUrls: ['./reporte-exportable-pdf.component.css']\r\n})\r\nexport class ReporteExportablePdfComponent implements OnInit {\r\n\r\n  public BreadLevel01 = 'Reportes';\r\n  public Title = 'Reporte exportable en PDF';\r\n\r\n  filterProject: FilterProjectAssigned = new FilterProjectAssigned();\r\n\r\n  projectList: any[] = [];\r\n  listProjectFilter: any[] = [];\r\n\r\n  listState: MasterTable[] = [];\r\n  ProjectTypeDropDownList: DropDownList[];\r\n\r\n  codigoProyecto: Observable<any[]>;\r\n  nombreProyecto: Observable<any[]>;\r\n  \r\n  myControl: FormControl = new FormControl();\r\n  myControll: FormControl = new FormControl();\r\n  \r\n  inputNombreServicio = \"\";\r\n\r\n  permisoAdministrador: boolean = true;\r\n  user: User = new User();\r\n\r\n  currentPage: number = 1;\r\n  itemsPerPage: number = 999;\r\n  totalItems: number = 0;\r\n\r\n  grafico1: Chart;\r\n  grafico2: Chart;\r\n  grafico3: Chart;\r\n  \r\n  // Operación\r\n  scodproject = \"\";\r\n  projectStep5 :ProjectStep5 = new ProjectStep5();\r\n  listInvoicing: ProjectInvoicing[] = [];\r\n  ingresosReales: number = 0;\r\n  costoReal: number = 0;\r\n  costoReal1: number = 0;\r\n  listCost:PersonCostHist[] = [];\r\n\r\n  listprogress: Progress[] = []; \r\n  listAvanceProyecto: ProgressDetail[] = []; \r\n\r\n  listInvestment :ProjectStep3Investment[]=[];\r\n  projectStep2: ProjectStep2 = new ProjectStep2();\r\n  ListWeekProgressn: WeekAvance[] = [];\r\n  ListWeekPerson: WeeksProjectPerson[] = [];\r\n  ncantidadsemanas: number = 0;\r\n  arrayNumberWeek: number[] = [];\r\n  listProjectHoursLog:any[] = [];\r\n\r\n  listSemanasStart: Date[]=[];\r\n  listSemanasFinish: Date[]=[]; \r\n  listhoras: number[]=[];\r\n  listCostoPlanificado: number[]=[];\r\n  listCostoReal: number[]=[];\r\n  \r\n  \r\n  listProjectEstimate:ProjectEstimate[] = [];\r\n  listProjectEstimateAuxiliary: ProjectEstimate[];\r\n  listProjectPersonal: ProjectEstimate[];\r\n\r\n  cantidad_columnas = 2;\r\n  personHours: Array<[any, number[], any]>; \r\n\r\n  facturacion_montoesperado = [];\r\n  facturacion_montofacturado = [];\r\n  facturacion_montoreal = [];\r\n  facturacion_labels = [];\r\n\r\n  let_mes = new Map([\r\n    [0, \"Enero\" ],\r\n    [1, \"Febrero\"],\r\n    [2, \"Marzo\"],\r\n    [3, \"Abril\"],\r\n    [4, \"Mayo\"],\r\n    [5, \"Junio\"],\r\n    [6, \"Julio\"],\r\n    [7, \"Agosto\"],\r\n    [8, \"Septiembre\"],\r\n    [9, \"Octubre\"],\r\n    [10, \"Noviembre\"],\r\n    [11, \"Diciembre\"]\r\n  ])\r\n  mesesLabel: string[] = [];\r\n  \r\n  date1String: string = \"\"\r\n  date2String: string = \"\"\r\n  \r\n  dateMax: string = \"\";\r\n  dateMin: string = \"\";\r\n  \r\n  simbMoneda = \"\";\r\n  listProjectHoursExt: any[] = [];\r\n\r\n\r\n  showData = false;\r\n\r\n  cumplimiento_tareasATiempo = 0;\r\n  cumplimiento_tareasFueraDeTiempo = 0;\r\n  cumplimiento_tareasTerminadas = 0;\r\n  cumplimiento_avanceDelProyecto = 0;\r\n  cumplimiento_totalTareas = 0;\r\n\r\n  constructor(\r\n    private mastertableService: MastertableService,\r\n    private spinner: NgxSpinnerService,\r\n    private projectTypeService: ProjectTypeService,\r\n    private projectService: ProjectService,\r\n    private servicePerson: PersonService,\r\n  ) { \r\n    this.filterProject.pagination.ItemsPerPage = this.itemsPerPage;\r\n    this.filterProject.pagination.TotalItems = this.totalItems;\r\n    this.filterProject.pagination.CurrentPage = this.currentPage;\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.showData = false;\r\n\r\n    this.RenderChart();\r\n\r\n    if (sessionStorage.getItem('Guard') !== null) {\r\n      this.user = JSON.parse(sessionStorage.getItem('User'));\r\n    }\r\n\r\n    this.getState();\r\n    this.getProjectTypeDropDown();\r\n    this.getProyectos();\r\n\r\n    this.codigoProyecto = this.myControl.valueChanges\r\n    .pipe(\r\n      startWith(''),\r\n      map((val: any) => this.filter(val))\r\n    );\r\n\r\n  this.nombreProyecto = this.myControll.valueChanges\r\n    .pipe(\r\n      startWith(''),\r\n      map((val: any) => this.filter2(val))\r\n    );\r\n\r\n\r\n  }\r\n\r\n  filter(val: string): string[] {\r\n    return this.listProjectFilter.filter(project =>\r\n      project.scodproject.toLowerCase().indexOf(val.toLowerCase()) === 0);\r\n  }\r\n\r\n  filter2(val: string): string[] {\r\n    return this.listProjectFilter.filter(project =>\r\n      project.snameproject.toLowerCase().indexOf(val.toLowerCase()) === 0);\r\n  }\r\n\r\n  changeNombreServicio() {\r\n    let proyecto = this.projectList.find(project => project.snameproject == this.inputNombreServicio);\r\n    if(proyecto !== null && proyecto !== undefined) {\r\n      this.filterProject.scodproject = proyecto.scodproject;\r\n    }\r\n  }\r\n\r\n  changeCodigoServicio() {\r\n    console.log(this.filterProject.scodproject);\r\n    let proyecto = this.projectList.find(project => project.scodproject == this.filterProject.scodproject);\r\n    if(proyecto !== null && proyecto !== undefined) {\r\n      this.inputNombreServicio = proyecto.snameproject;\r\n    }\r\n  }\r\n\r\n  changeEstado() {\r\n    if(this.filterProject.nid_status == 0) {\r\n      this.listProjectFilter = this.projectList;\r\n    } else {\r\n      let cadena = this.listState.find(stado => stado.nid_mastertable_type == this.filterProject.nid_status).sshort_value.toUpperCase();\r\n      this.listProjectFilter = this.projectList.filter(proyecto => proyecto.sstatusname.toUpperCase() == cadena);\r\n    }\r\n    this.myControl.setValue(\"\");\r\n    this.myControll.setValue(\"\");\r\n  }\r\n\r\n  fisrtChange() {\r\n    this.myControl.setValue(\"\");\r\n    this.myControll.setValue(\"\");\r\n  }\r\n\r\n  getState() {\r\n    this.spinner.show('SpinnerProject');\r\n    //let idFather=this.listCategory.find(x=>x.nid_mastertable_type==id).nid_mastertable;\r\n    this.mastertableService.getmastertable(50).subscribe((response: any) => {\r\n      this.listState = response;\r\n      this.listState = this.listState.filter(x => x.sshort_value == \"ACTIVO\" ||  x.sshort_value == \"CERRADO\")\r\n\r\n      this.spinner.hide('SpinnerProject');\r\n\r\n    }, (error) => {\r\n      console.error(error);\r\n      this.spinner.hide('SpinnerProject');\r\n    });\r\n  }\r\n\r\n  getProjectTypeDropDown() {\r\n\r\n    this.spinner.show('SpinnerProject');\r\n    this.projectTypeService.getDropdownlist().subscribe((response: any) => {\r\n\r\n      if (response == null) {\r\n        this.filterProject.nid_project_type = 0;\r\n        return;\r\n      }\r\n      this.ProjectTypeDropDownList = response;\r\n      if (this.ProjectTypeDropDownList.length > 0) {\r\n        this.filterProject.nid_project_type = 0;\r\n      }\r\n      this.spinner.hide('SpinnerProject');\r\n    }, (error) => {\r\n      console.error(error);\r\n      this.spinner.hide('SpinnerProject');\r\n    });\r\n  }\r\n\r\n  getProyectos() {\r\n    this.filterProject.nid_manager = 0;\r\n    this.filterProject.nid_status = 0;\r\n    \r\n    if(this.permisoAdministrador) {\r\n      this.filterProject.nid_manager=0;\r\n      this.filterProject.nid_person = 0;\r\n    } else {\r\n      this.filterProject.nid_manager=0;\r\n      this.filterProject.nid_person = this.user.nid_person;\r\n    }\r\n    \r\n    this.spinner.show();\r\n    this.projectService.getassignedprojectpagination(this.filterProject).subscribe(\r\n      (res: any) => {\r\n        try {\r\n          if (res == null) {\r\n            Swal.fire({\r\n              icon: 'error',\r\n              title: 'Ocurrió un error al obtener los registros.',\r\n              //text: 'Por favor, escríbenos a la siguiente dirección: ' +'comercial@crecerseguros.pe. Nuestro ejecutivo comercial se contactará contigo'\r\n            });\r\n          }\r\n          this.spinner.hide();\r\n          this.projectList = res.data;\r\n          this.listProjectFilter = res.data;\r\n          this.fisrtChange();\r\n          this.totalItems = res.pagination.totalItems;\r\n        } catch (e) {\r\n          this.spinner.hide();\r\n          this.projectList = null;\r\n          this.totalItems = 0;\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  search(){\r\n    this.showData = true;\r\n    this.scodproject = this.filterProject.scodproject;\r\n    this.esperarRespuesta();\r\n  }\r\n\r\n  esperarRespuesta() {\r\n    var projectStep3 = lastValueFrom(this.projectService.getprojectdtep3(this.scodproject));\r\n    var projectStep2 = lastValueFrom(this.projectService.getprojectdtep2(this.scodproject));\r\n    var projectStep5 = lastValueFrom(this.projectService.getprojectdtep5(this.scodproject));\r\n\r\n    // Devuelve la facturacion\r\n    var facturacionProyecto = lastValueFrom(this.projectService.getprojectinvoicing(this.scodproject));\r\n\r\n    // Devuelve el costo para cada integrante del proyecto  \r\n    var costoIntegrantes = lastValueFrom(this.servicePerson.getPersonCostByScodproject(this.scodproject));\r\n\r\n    // Esto devuelve las horas estimadas\r\n    var horasEstimadas = lastValueFrom(this.projectService.getprojectweekperson(this.scodproject));\r\n\r\n    // La lista de personal estimado\r\n    var personalEstimado = lastValueFrom(this.projectService.getprojectestimate(this.scodproject, 2));\r\n\r\n    // Devuelve las horas registradas para el proyecto\r\n    var horasRegistradas= lastValueFrom(this.projectService.getprojecthourslog(this.scodproject));\r\n\r\n    // Devuelve los registros\r\n    var registrosAvanceProject= lastValueFrom(this.projectService.getprojectprogress(this.scodproject));\r\n\r\n    // Obtener horas registradas de personal externo y proveedores\r\n    var horasRegistradasExt = lastValueFrom(this.projectService.getprojecthoursext(this.scodproject));\r\n\r\n    this.spinner.show('SpinnerProject');\r\n    Promise.all([projectStep3, projectStep2, costoIntegrantes, horasEstimadas, personalEstimado, horasRegistradas, projectStep5, facturacionProyecto, registrosAvanceProject, horasRegistradasExt]).then((value: any) => {\r\n      this.spinner.hide('SpinnerProject');\r\n\r\n\r\n      // Step 3, obtiene la lista de estimados, con su costo estimado por rol\r\n      this.listInvestment = value[0].listInvestment;\r\n      \r\n      // Step 2\r\n      this.projectStep2 = value[1];\r\n      \r\n      if(this.projectStep2.ncurrency == 1) {\r\n        this.simbMoneda = \"S/.\";\r\n      } else {\r\n        this.simbMoneda = \"$\";\r\n      }\r\n\r\n      this.date1String = this.projectStep2.dbegin_date.substring(0,7)\r\n      this.dateMin = this.projectStep2.dbegin_date.substring(0,7);\r\n      this.date2String = this.projectStep2.dfinish_date.substring(0,7);\r\n      this.dateMax = this.projectStep2.dfinish_date.substring(0,7);\r\n      this.ncantidadsemanas = this.projectStep2.nweeks;\r\n      this.arrayNumberWeek = new Array<number>(this.ncantidadsemanas);\r\n      this.generateArregloSemanas();\r\n      \r\n      // Costo Real Integrantes del proyecto\r\n      this.listCost = value[2];\r\n      if(this.listCost === null || this.listCost === undefined) {\r\n        this.mensajeError(\"Debe asignar personal al proyecto\");\r\n        return;\r\n      }\r\n      console.log(\"La lista de costos\", this.listCost);\r\n      \r\n      this.listCost.forEach(element => {\r\n        element.dcost_date = new Date(element.dcost_date);\r\n      });\r\n\r\n      // Horas estimadas\r\n      this.ListWeekPerson = value[3];\r\n      \r\n\r\n      // Personal\r\n      this.listProjectPersonal = value[4];\r\n      // Personal estimado no auxiliar\r\n      this.listProjectEstimate = value[4].filter(x=> x.isAuxiliary == false);\r\n      // Personal Auxiliar\r\n      this.listProjectEstimateAuxiliary = value[4].filter(ls => ls.isAuxiliary == true);\r\n      \r\n      \r\n      // Horas Registradas\r\n      this.calculateCostoPlanificado();\r\n      \r\n      if(value[5]=== null || value[5]=== undefined) {\r\n        this.mensajeError(\"No existen horas registradas en el proyecto\");\r\n        return;\r\n      }\r\n\r\n      this.listProjectHoursLog = value[5].filter(x => x.sstate == \"A\");\r\n\r\n      // Step 5\r\n      this.projectStep5 = value[6];\r\n      console.log(this.projectStep5);\r\n      \r\n      // Facturacion del proyecto\r\n      this.listInvoicing = value[7];\r\n      this.calculoFacturacion();\r\n      \r\n      // Obtener ultimo registro de avance\r\n      this.listprogress = value[8];\r\n      if(this.listprogress != null && this.listprogress.length >= 1) {\r\n        this.listAvanceProyecto = this.listprogress[0].listProgressDetail;\r\n        this.llenarGrafico2();\r\n      } else {\r\n        this.listAvanceProyecto = [];\r\n      }\r\n\r\n      if(value[9]!=null){\r\n        this.listProjectHoursExt = value[9].filter(x => x.sstate == \"A\");\r\n        console.log(this.listProjectHoursExt);     \r\n      } else {\r\n        this.listProjectHoursExt = [];\r\n      }\r\n\r\n    \r\n      this.calculo();\r\n      this.calcularCostoReal();\r\n      this.llenarNuevoGrafico();\r\n\r\n    })\r\n  }\r\n\r\n  calculoFacturacion() {\r\n    let esperado = [];\r\n    let real = [];\r\n    let facturado = [];\r\n\r\n    this.facturacion_montoesperado = [];\r\n    this.facturacion_montofacturado = [];\r\n    this.facturacion_montoreal = [];\r\n    this.facturacion_labels = [];\r\n\r\n    if(this.listInvoicing != null) {\r\n      this.ingresosReales = 0;\r\n      this.listInvoicing.forEach(invo => {\r\n        let date_esperado = new Date(invo.dplanned_date);\r\n        date_esperado.setDate(date_esperado.getDate() + 1);\r\n        date_esperado.setHours(0,0,0,0);\r\n        esperado.push([date_esperado, 1, invo.namount]);\r\n        \r\n        if(invo.binvoiced) {\r\n          let date_facturado = new Date(invo.dbilling_date);\r\n          date_facturado.setDate(date_facturado.getDate() + 1);\r\n          date_facturado.setHours(0,0,0,0);\r\n          facturado.push([date_facturado, 2, invo.namount]);\r\n        }\r\n\r\n        if(invo.bpaid) {\r\n          this.ingresosReales +=  Number(invo.namount);\r\n          let date_real = new Date(invo.dinvoice_payment_date);\r\n          date_real.setDate(date_real.getDate()+1);\r\n          date_real.setHours(0,0,0,0);\r\n          real.push([date_real, 3, invo.namount]);\r\n        }\r\n\r\n      });\r\n\r\n      let allDates = [...esperado, ...real, ...facturado];\r\n      allDates.sort((a: [Date, number, number], b: [Date, number, number]) => a[0].getTime() - b[0].getTime());\r\n\r\n      let fechasUnicas: string[] = [];\r\n      let fechaAnterior: string = '';\r\n\r\n      for (let fecha of allDates) {\r\n        let fechaString: string = this.convertDatetoString(fecha[0]);\r\n        if (fechaString !== fechaAnterior) {\r\n          fechasUnicas.push(fechaString);\r\n          fechaAnterior = fechaString;\r\n        }\r\n      }\r\n\r\n      let montoEsperado= [];\r\n      let montoFacturado= [];\r\n      let montoReal = [];\r\n\r\n      for(let fecha of fechasUnicas) {\r\n        montoEsperado.push([fecha, 0]);\r\n        montoFacturado.push([fecha, 0]);\r\n        montoReal.push([fecha, 0]);\r\n      }\r\n\r\n      for (let fecha of allDates) {\r\n        let fechaString: string = this.convertDatetoString(fecha[0]);\r\n        let encontrado;\r\n        if(fecha[1] == 1) {\r\n          encontrado = montoEsperado.find(x=>x[0] == fechaString);\r\n          encontrado[1] += fecha[2];\r\n        }\r\n        if(fecha[1] == 2) {\r\n          encontrado = montoFacturado.find(x=>x[0] == fechaString);\r\n          encontrado[1] += fecha[2];\r\n        }\r\n        if(fecha[1] == 3) {\r\n          encontrado = montoReal.find(x=>x[0] == fechaString);\r\n          encontrado[1] += fecha[2];\r\n        }\r\n      }\r\n      \r\n      // Esto es solo por decoracion\r\n      let suma_valor1 = 0;\r\n      for (let i = 0 ; i < montoEsperado.length; i ++) {\r\n        suma_valor1 += montoEsperado[i][1];\r\n        montoEsperado[i][1] = suma_valor1;\r\n      }\r\n\r\n      let suma_valor2 = 0;\r\n      for (let i = 0 ; i < montoFacturado.length; i ++) {\r\n        suma_valor2 += montoFacturado[i][1];\r\n        montoFacturado[i][1] = suma_valor2;\r\n      }\r\n\r\n      let suma_valor3 = 0;\r\n      for (let i = 0 ; i < montoReal.length; i ++) {\r\n        suma_valor3 += montoReal[i][1];\r\n        montoReal[i][1] = suma_valor3;\r\n      }\r\n\r\n      this.facturacion_montoesperado = montoEsperado;\r\n      this.facturacion_montofacturado = montoFacturado;\r\n      this.facturacion_montoreal = montoReal;\r\n      this.facturacion_labels = fechasUnicas;\r\n      this.llenarGrafico3()\r\n      \r\n    } else {\r\n      this.listInvoicing = [];\r\n      this.ingresosReales = 0;\r\n    }\r\n  }\r\n\r\n  convertDatetoString(fecha: Date) {\r\n    return fecha.getDate().toString().padStart(2,'0') + '/' + (fecha.getMonth() + 1).toString().padStart(2,'0') + \"/\" + fecha.getFullYear()\r\n  }\r\n\r\n  generateArregloSemanas() {\r\n    // Limpiar datos\r\n    this.listSemanasStart = [];\r\n    this.listSemanasFinish = [];\r\n\r\n\r\n    let fechaIni;\r\n    let fechaFin;\r\n    fechaIni = new Date(this.projectStep2.dbegin_date);\r\n    fechaIni.setDate(fechaIni.getDate() + 1);\r\n\r\n    // Si la semana empieza miercoles la fecha fin de esta semana termina en 3 dias, sabado\r\n    let dateuno = 6 - fechaIni.getDay();\r\n    // Si empieza sabado vuela todo XXD\r\n    fechaFin = new Date(this.projectStep2.dbegin_date);\r\n    fechaFin.setDate(fechaFin.getDate() + (1+dateuno));\r\n\r\n    let abc = new Date(fechaIni.setDate(fechaIni.getDate() + 0));\r\n    let abd = new Date(fechaFin.setDate(fechaFin.getDate() + 0));\r\n    this.listSemanasStart.push(abc);\r\n    this.listSemanasFinish.push(abd);\r\n\r\n    let newDate = new Date(this.projectStep2.dfinish_date);\r\n    newDate.setDate(newDate.getDate() + 1);\r\n    let primeraIteracion = true;\r\n    while(fechaFin <= newDate){\r\n      // Si entra es porque fechaFin aun no es menor que newDate\r\n      let abc;\r\n      if(primeraIteracion) {\r\n        let sumarPrimeraIteracion = 8 - fechaIni.getDay();\r\n        abc =new Date(fechaIni.setDate(fechaIni.getDate()+sumarPrimeraIteracion));\r\n        primeraIteracion = false;\r\n      } else {\r\n        abc =new Date(fechaIni.setDate(fechaIni.getDate()+7));\r\n      }\r\n\r\n      let abd;         \r\n      if(abc <= newDate) {\r\n        abd =new Date(fechaFin.setDate(fechaFin.getDate()+7));\r\n        if(abd <= newDate) {\r\n          this.listSemanasStart.push(abc);\r\n          this.listSemanasFinish.push(abd);\r\n        } else {\r\n          let abd2 = new Date(fechaFin.setDate(fechaFin.getDate()-7));\r\n          let ultimaSemana = new Date(newDate);\r\n          ultimaSemana.setDate(ultimaSemana.getDate() -1 );\r\n          while (abd2 < ultimaSemana) { // Mientras que sea menor, para que en la ultima iteracion quede igual\r\n            abd2.setDate(abd2.getDate() + 1)\r\n          }\r\n          this.listSemanasStart.push(abc);\r\n          this.listSemanasFinish.push(abd2);\r\n        }\r\n      } else {\r\n        // Ya no deberia entrar a otra semana si es mayor que el newdate\r\n        fechaFin.setDate(fechaFin.getDate()+1);\r\n      }\r\n    }\r\n    this.listhoras = [];\r\n    // Una vez que obtengo las semana se debe crear el arreglo de horas\r\n    \r\n    for (let index = 0; index < this.listSemanasStart.length; index++) {\r\n      this.listhoras[index] = 0;\r\n      this.listCostoPlanificado[index] = 0;\r\n      this.listCostoReal[index] = 0;\r\n    }\r\n  }\r\n\r\n  calculateCostoPlanificado() {\r\n    for(let i=0; i<this.ncantidadsemanas; i++) {\r\n      for(let person of this.listProjectEstimate) {\r\n        let rol = this.listInvestment.find(x=> x.nid_rol == person.nid_rol);\r\n        let hora_estimada_semana = this.ListWeekPerson.filter(x => (x.nweeknumber == i+1 && x.nid_person==person.nid_person)).reduce((sum, current) => Number(sum) + Number(current.nhours_asigned), 0);\r\n        let costoPlanificado = Number(rol.ncost_per_hour) * Number(hora_estimada_semana);\r\n        this.listCostoPlanificado[i] += Number(costoPlanificado);\r\n        this.listCostoPlanificado[i] = Number(this.listCostoPlanificado[i].toFixed(2));\r\n        }\r\n    }\r\n  }\r\n\r\n  getCostoReal(nid_person, fechaRegistro) {\r\n    // Number(this.listCost.find(x=>x.nid_person == nid_person).ncost)\r\n    var histCost = this.listCost.filter(x=>x.nid_person == nid_person);\r\n    histCost.sort(function(a,b): any{\r\n      return a.dcost_date.getTime() - b.dcost_date.getTime();\r\n    });\r\n\r\n    var ultima_pos = histCost.length - 1;\r\n    if(ultima_pos < 0) {\r\n      // show error message\r\n      console.log(\"No hay costos para esta persona\");\r\n      return 0;\r\n    }\r\n    // La lista ordenada DESC\r\n    if(fechaRegistro >= histCost[ultima_pos].dcost_date) {\r\n      return histCost[ultima_pos].ncost;\r\n    } else {\r\n      // Validar a que rango corresponde\r\n      for(let i = 0; i< ultima_pos; i++) {\r\n        if(fechaRegistro >= histCost[i].dcost_date && fechaRegistro < histCost[i+1].dcost_date) {\r\n          return histCost[i].ncost;\r\n        } \r\n      }\r\n    }\r\n\r\n\r\n    // Si llega aca, el algoritmo esta mal xd o un personal registro hora cuando no tenia asignado costo (registra 09/10 y su primer costo registrado es 10/10)\r\n    console.log(\"Error algoritmo fallido\", nid_person, fechaRegistro);\r\n    // He tenido problemas porque hay usuarios que tienen su costo 27-3-2023 y registran el 22-03-2023 pues no les retorna una costoReal\r\n    // En este caso retornaré la primera ingresada\r\n    return histCost[0].ncost;\r\n  }\r\n\r\n  calculo(){\r\n    let fechaIni;\r\n    let horas;\r\n    let personId\r\n\r\n    this.personHours = [];\r\n\r\n    for(let i=0; i<this.listProjectHoursLog.length;i++){\r\n      fechaIni = new Date(this.listProjectHoursLog[i].dregistration_date);\r\n\r\n      personId = this.listProjectHoursLog[i].nid_person;\r\n      horas= this.listProjectHoursLog[i].nnumber_hours;\r\n\r\n      let costoReal = this.getCostoReal(personId, fechaIni);\r\n      let sperson = this.listProjectHoursLog[i].sperson;\r\n\r\n      let existingPerson = this.personHours.find((person) => person[0] === personId);\r\n\r\n      if (!existingPerson) {\r\n        let newArrayHoursForPerson = this.createArraySemanasWithCeros();\r\n        this.personHours.push([personId, newArrayHoursForPerson, sperson]); // Agregar nueva persona y sus horas\r\n      } \r\n\r\n      this.PerteneceSemana(fechaIni,horas, costoReal, personId);\r\n    }\r\n\r\n    for (let i = 0; i < this.listProjectHoursExt.length; i++) {\r\n      fechaIni = new Date(this.listProjectHoursExt[i].dregistration_date);\r\n\r\n      personId = this.listProjectHoursExt[i].nid_person;\r\n      horas = this.listProjectHoursExt[i].nnumber_hours;\r\n\r\n      let costoReal = this.listProjectHoursExt[i].costohora;\r\n      let sperson = this.listProjectHoursExt[i].sperson;\r\n\r\n      let existingPerson = this.personHours.find((person) => person[0] === personId);\r\n\r\n      if (!existingPerson) {\r\n        let newArrayHoursForPerson = this.createArraySemanasWithCeros();\r\n        this.personHours.push([personId, newArrayHoursForPerson, sperson]); // Agregar nueva persona y sus horas\r\n      }\r\n      this.PerteneceSemana(fechaIni, horas, costoReal, personId);\r\n    }\r\n\r\n    // Lista de todos los integrantes y en caso no este su id dentro de personHours deberia crearles su arreglo con todo 0\r\n    for(let i=0; i< this.listProjectPersonal.length; i++) {\r\n      let existingPerson2 = this.personHours.find((personHour) => personHour[0] == this.listProjectPersonal[i].nid_person);\r\n      if(!existingPerson2) {\r\n        let newArrayHoursForPerson = this.createArraySemanasWithCeros();\r\n        this.personHours.push([personId, newArrayHoursForPerson, this.listProjectPersonal[i].sperson]); // Agregar nueva persona y sus horas\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  createArraySemanasWithCeros() {\r\n    let newArrayHoursForPerson = [];\r\n    for (let index = 0; index < this.listSemanasStart.length; index++) {\r\n      newArrayHoursForPerson[index] = 0;\r\n    }\r\n    return newArrayHoursForPerson;\r\n  }\r\n\r\n  PerteneceSemana(fechaIni,horas,costoReal, personId){\r\n    let semana_pertenece = -1;\r\n    for(let i=0; i<this.listSemanasFinish.length;i++){\r\n      if(fechaIni >=this.listSemanasStart[i] && fechaIni<=this.listSemanasFinish[i]){\r\n        semana_pertenece = i;\r\n        break;\r\n      }\r\n    }\r\n    \r\n    if(semana_pertenece == -1) {\r\n      return;\r\n    }\r\n\r\n    this.listhoras[semana_pertenece] += horas;\r\n    this.listCostoReal[semana_pertenece] += Number(horas*costoReal);\r\n    this.listCostoReal[semana_pertenece] = Number(this.listCostoReal[semana_pertenece].toFixed(2));\r\n\r\n    // Agrego horas en las semanas de una persona\r\n    this.personHours.find((person) => person[0] === personId)[1][semana_pertenece] += horas;\r\n  }\r\n\r\n  calcularCostoReal() {\r\n    let fechaRegistro;\r\n    let horas;\r\n    this.costoReal = 0;\r\n\r\n    for(let i=0; i<this.listProjectHoursLog.length;i++){\r\n      fechaRegistro = new Date(this.listProjectHoursLog[i].dregistration_date);\r\n      fechaRegistro.setDate(fechaRegistro.getDate() + 1);\r\n\r\n      let costoRealIntegrante = this.getCostoReal(this.listProjectHoursLog[i].nid_person, fechaRegistro);\r\n      horas = this.listProjectHoursLog[i].nnumber_hours;\r\n      this.costoReal += (Number(costoRealIntegrante) * Number(horas));\r\n    }\r\n\r\n    for(let i = 0; i< this.listProjectHoursExt.length; i++) {\r\n      horas= this.listProjectHoursExt[i].nnumber_hours;\r\n      let costoReal = this.listProjectHoursExt[i].costohora;\r\n      this.costoReal += (Number(costoReal) * Number(horas));\r\n    }\r\n  }\r\n\r\n  FilterPersonWeek(nidperson: number) {\r\n    let lista = this.ListWeekPerson.filter(x => x.nid_person == nidperson);\r\n    return lista.slice(0, this.ncantidadsemanas);\r\n  }\r\n\r\n  mensajeError(message: string) {\r\n    Swal.fire('Error', message, 'info');\r\n  }\r\n\r\n  llenarGrafico2() {\r\n    this.grafico2.data.datasets = [];\r\n\r\n\r\n    this.cumplimiento_tareasATiempo = 0;\r\n    this.cumplimiento_tareasFueraDeTiempo = 0;\r\n    this.cumplimiento_tareasTerminadas = 0;\r\n    this.cumplimiento_avanceDelProyecto = 0;\r\n    this.cumplimiento_totalTareas = this.listAvanceProyecto.length;\r\n  \r\n\r\n    for (let i = 0; i < this.listAvanceProyecto.length; i++) {\r\n      \r\n      const tarea = this.listAvanceProyecto[i];\r\n      \r\n      let color;\r\n      if(tarea.real >= tarea.planificado) {\r\n        color = \"#00ff00\";\r\n        tarea.planificado == 100? this.cumplimiento_tareasTerminadas += 1 : this.cumplimiento_tareasATiempo += 1;\r\n      } else {\r\n        this.cumplimiento_tareasFueraDeTiempo += 1;\r\n        color = \"#ff0000\";\r\n      }\r\n\r\n      let newData = {\r\n        label: tarea.name,\r\n        data: [{x: tarea.planificado, y: tarea.real}],\r\n        borderWidth: 1,\r\n        backgroundColor: [color],\r\n        pointRadius: 8\r\n      }\r\n\r\n      this.grafico2.data.datasets.push(newData);\r\n\r\n    }\r\n    this.grafico2.update();\r\n\r\n  }\r\n\r\n  llenarGrafico3(){\r\n    this.grafico3.data.labels = this.facturacion_labels;\r\n\r\n    this.grafico3.data.datasets = [];\r\n    this.grafico3.data.datasets.push({\r\n      label: 'Esperado',\r\n      data: this.facturacion_montoesperado,\r\n      borderWidth: 2,\r\n    })\r\n    this.grafico3.data.datasets.push({\r\n      label: 'Real',\r\n      data: this.facturacion_montoreal,\r\n      borderWidth: 2,\r\n    })\r\n    this.grafico3.data.datasets.push({\r\n      label: 'Facturado',\r\n      data: this.facturacion_montofacturado,\r\n      borderWidth: 2,\r\n    })\r\n    this.grafico3.update();\r\n  }\r\n\r\n  llenarNuevoGrafico() {\r\n    this.grafico1.data.labels = [];\r\n    this.grafico1.data.datasets[0].data = [];\r\n    this.grafico1.data.datasets[1].data = [];\r\n\r\n    this.grafico1.data.labels.push(\"Ingresos\")\r\n    this.grafico1.data.datasets[0].data.push(this.projectStep5.nexpected_income);\r\n    this.grafico1.data.datasets[1].data.push(this.ingresosReales);\r\n    \r\n    this.grafico1.data.labels.push(\"Costos\")\r\n    this.grafico1.data.datasets[0].data.push(this.projectStep5.ntotal_investment + this.projectStep5.ntotal_external_cost);\r\n    this.grafico1.data.datasets[1].data.push(this.costoReal);\r\n\r\n    this.grafico1.data.labels.push(\"Utilidad\")\r\n    this.grafico1.data.datasets[0].data.push(this.projectStep5.nexpected_utility);\r\n    this.grafico1.data.datasets[1].data.push((this.ingresosReales - this.costoReal));\r\n    \r\n    this.grafico1.update();\r\n  }\r\n\r\n  RenderChart() {\r\n    this.grafico1 = new Chart(\"barchart1\", {\r\n      type: 'bar',\r\n      data: {\r\n        labels: [],\r\n        datasets: [\r\n          {\r\n            label: 'Esperado',\r\n            data: [],\r\n            borderWidth: 1,\r\n            backgroundColor: [\"#41cfe3\"]\r\n          },\r\n          {\r\n            label: 'Real',\r\n            data: [],\r\n            borderWidth: 1,\r\n            backgroundColor: [\"#ec7c1c\"]\r\n          }\r\n        ]\r\n      },\r\n      options: {\r\n        responsive: true,\r\n        maintainAspectRatio: false,\r\n        scales: {\r\n          y: {\r\n            beginAtZero: true,\r\n            // min: 0,\r\n            // suggestedMax: 100,\r\n            ticks: {\r\n              callback: function(value, index, ticks) {\r\n                return \"S/.\" + Number(value).toFixed(0);\r\n              }\r\n            }\r\n          }\r\n        },\r\n        datasets: {\r\n          bar: {\r\n            barPercentage: 1\r\n          }\r\n        },\r\n        plugins: {\r\n          title: {\r\n            display: true,\r\n            text: 'RENTABILIDAD DEL PROYECTO'\r\n          },\r\n          legend: {\r\n            position: 'bottom'\r\n          },\r\n          tooltip: {\r\n            callbacks: {\r\n              label: function(context) {\r\n                let label = context.dataset.label || '';\r\n\r\n                if (label) {\r\n                    label += ': ';\r\n                }\r\n                if (context.parsed.y !== null) {\r\n                    label += \"S/.\" +  context.parsed.y.toFixed(2);\r\n                }\r\n                return label;\r\n              }\r\n            }\r\n          },\r\n          datalabels: {\r\n            anchor: 'center',\r\n            align: 'center',\r\n            font: {\r\n              weight: 'bold'\r\n            },\r\n            color: '#fff',\r\n            formatter: function(value, context) {\r\n              return \"S/.\" + Number(value).toFixed(0);\r\n            }\r\n          }\r\n        }\r\n      },\r\n    });\r\n\r\n    this.grafico2 = new Chart('chartCanvas', {\r\n      type: 'scatter',\r\n      data: {\r\n        datasets: []\r\n      },\r\n      options: {\r\n        responsive: true,\r\n        maintainAspectRatio: false,\r\n        scales: {\r\n          x: {\r\n            type: 'linear',\r\n            position: 'bottom',\r\n            min: 0,\r\n            max: 100,\r\n            title: {\r\n              display: true,\r\n              text: 'Avance Planificado'\r\n            },\r\n            ticks: {\r\n              callback: function (value, index, ticks) {\r\n                return Number(value).toFixed(0) + '%';\r\n              }\r\n            }\r\n          },\r\n          y: {\r\n            type: 'linear',\r\n            position: 'left',\r\n            min: 0,\r\n            max: 100,\r\n            title: {\r\n              display: true,\r\n              text: 'Avance Real'\r\n            },\r\n            ticks: {\r\n              callback: function (value, index, ticks) {\r\n                return Number(value).toFixed(0) + '%';\r\n              }\r\n            }\r\n          }\r\n        },\r\n        plugins: {\r\n          title: {\r\n            display: true,\r\n            text: 'CUMPLIMIENTO DEL CRONOGRAMA'\r\n          },\r\n          legend: {\r\n            display: false\r\n          },\r\n          tooltip: {\r\n            callbacks: {\r\n              label: function (context) {\r\n                let label = context.dataset.label || '';\r\n      \r\n                if (label) {\r\n                  label += ': ';\r\n                }\r\n                if (context.parsed.x !== null && context.parsed.y !== null) {\r\n                  const planificado = context.parsed.x;\r\n                  const real = context.parsed.y;\r\n      \r\n                  label += 'Planificado: ' + planificado.toFixed(2) + '%, Real: ' + real.toFixed(2) + '%';\r\n                }\r\n                return label;\r\n              }\r\n            }\r\n          }\r\n        },\r\n       \r\n      }\r\n    });\r\n\r\n    this.grafico3 = new Chart('ganttChart', {\r\n      type: 'line',\r\n      data: {\r\n        labels: ['17-Enero', '30-Enero', '1-Febrero'],\r\n        datasets: [\r\n          {\r\n            label: 'Real',\r\n            data: [1000, 2000, 3000 ],\r\n          },\r\n          {\r\n            label: 'Esperado',\r\n            data: [2000, 3000,5000]\r\n          }\r\n        ]\r\n      },\r\n      options: {\r\n        responsive: true,\r\n        maintainAspectRatio: false,\r\n        plugins: {\r\n          legend: {\r\n            position: 'bottom'\r\n          },\r\n          title: {\r\n            display: true,\r\n            text: 'Cumplimiento de hitos de facturación del proyecto'\r\n          }\r\n        },\r\n        elements: {\r\n          line: {\r\n            backgroundColor: ['#123d63', \"#ec7c1c\", \"#94bb68\"],\r\n            borderColor: ['#123d63', \"#ec7c1c\", \"#94bb68\"],\r\n          }   \r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  indicadorSemaforo(nweeknumber) {\r\n    let numero = this.listCostoPlanificado[nweeknumber];\r\n    let numero2 = this.listCostoReal[nweeknumber];\r\n    return numero >= numero2? 'green': 'red' ;\r\n  }\r\n\r\n  indicadorSemaforoNumber(nweeknumber) {\r\n    let numero = this.listCostoPlanificado[nweeknumber];\r\n    let numero2 = this.listCostoReal[nweeknumber];\r\n    return (numero - numero2).toFixed(2);\r\n  }\r\n\r\n  downloadAsPDF() {\r\n    const pdf = new jsPDF();\r\n\r\n    // Selecciona el elemento HTML que deseas convertir en PDF\r\n    const element = document.getElementById('pruebita')!;\r\n\r\n    // Convierte el elemento en una imagen utilizando html2canvas\r\n    html2canvas(element).then((canvas) => {\r\n      const imageData = canvas.toDataURL('image/png');\r\n\r\n      // Agrega la imagen al PDF\r\n      pdf.addImage(imageData, 'PNG', 10, 10, 190, 0);\r\n\r\n      // Descarga el PDF\r\n      pdf.save('vista.pdf');\r\n    });\r\n  }\r\n}\r\n","<div class=\"app-content content bg-white\">\r\n    <div class=\"content-wrapper\">\r\n        <!-- INICIO Breadcrumbs -->\r\n        <div class=\"content-header row\">\r\n            <div class=\"content-header-left col-md-6 col-12\">\r\n                <h3 class=\"content-header-title\">{{Title}}</h3>\r\n                <div class=\"row breadcrumbs-top\">\r\n                    <div class=\"breadcrumb-wrapper col-12\">\r\n                        <ol class=\"breadcrumb\">\r\n                            <li class=\"breadcrumb-item\"><a routerLink=\"/manage/inicio\">Inicio</a>\r\n                            </li>\r\n                            <li class=\"breadcrumb-item\"><a routerLink=\"/manage/indicador-gestion\">{{BreadLevel01}}</a>\r\n                            </li>\r\n                            <li class=\"breadcrumb-item active\">{{Title}}\r\n                            </li>\r\n                        </ol>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <!-- FIN Breadcrumbs -->\r\n        <div class=\"content-body\" id=\"pruebita\">\r\n            <div class=\"row \">\r\n                <div class=\"col-lg-12\">\r\n                    <div class=\"card\">\r\n                        <div class=\"card-header\">\r\n                            <h4 class=\"card-title\"> FILTROS </h4>\r\n                            <a class=\"heading-elements-toggle\"><i class=\"la la-ellipsis-v font-medium-3\"></i></a>\r\n                        </div>\r\n\r\n                        <div class=\"card-content collapse show\">\r\n                            <div class=\"card-body\">\r\n                                <div class=\"row\">\r\n                                    <div class=\"form-group col-md-2 col-sm-12\">\r\n                                        <label> Código Proyecto </label>\r\n                                        <mat-form-field style=\"width: 100%;\">\r\n                                            <input type=\"text\" aria-label=\"Number\" matInput [formControl]=\"myControl\"\r\n                                                [(ngModel)]=\"filterProject.scodproject\" [matAutocomplete]=\"auto\"\r\n                                                (change)=\"changeCodigoServicio()\">\r\n                                            <mat-autocomplete #auto=\"matAutocomplete\"\r\n                                                (optionSelected)=\"changeCodigoServicio()\">\r\n                                                <mat-option *ngFor=\"let option of codigoProyecto | async\"\r\n                                                    [value]=\"option.scodproject\" style=\"font-size:12px\">\r\n                                                    {{ option.scodproject }}\r\n                                                </mat-option>\r\n                                            </mat-autocomplete>\r\n                                        </mat-form-field>\r\n                                    </div>\r\n\r\n                                    <div class=\"form-group col-md-3 col-sm-12\">\r\n                                        <label> Nombre Proyecto </label>\r\n                                        <mat-form-field style=\"width: 100%;\">\r\n                                            <input type=\"text\" aria-label=\"Number\" matInput [formControl]=\"myControll\"\r\n                                                [matAutocomplete]=\"auto2\" [(ngModel)]=\"inputNombreServicio\"\r\n                                                (change)=\"changeNombreServicio()\">\r\n                                            <mat-autocomplete #auto2=\"matAutocomplete\" style=\"width: 300px;\"\r\n                                                (optionSelected)=\"changeNombreServicio()\">\r\n                                                <mat-option *ngFor=\"let option of nombreProyecto | async\"\r\n                                                    [value]=\"option.snameproject\" style=\"font-size:12px\">\r\n                                                    {{ option.snameproject }}\r\n                                                </mat-option>\r\n                                            </mat-autocomplete>\r\n                                        </mat-form-field>\r\n                                    </div>\r\n\r\n                                    <div class=\"form-group col-md-2 col-sm-12\">\r\n                                        <label> Estado </label>\r\n                                        <select class=\"select2 form-control block\" required\r\n                                            [(ngModel)]=\"filterProject.nid_status\" (change)=\"changeEstado()\">\r\n                                            <option value=\"0\">-- Seleccione --</option>\r\n                                            <option *ngFor=\"let item of listState\" [value]=\"item.nid_mastertable_type\">\r\n                                                {{item.sshort_value}}</option>\r\n                                        </select>\r\n                                    </div>\r\n\r\n                                    <div class=\"col-md-2 col-sm-12\">\r\n                                        <div class=\"form-actions\">\r\n                                            <button type=\"button\" class=\"btn btn-outline-info btn-active\"\r\n                                                (click)=\"search()\">\r\n                                                <i class=\"la la-search\"></i>&nbsp;Consultar\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div class=\"col-md-2 col-sm-12\">\r\n                                        <div class=\"form-actions\">\r\n                                            <button type=\"button\" (click)=\"downloadAsPDF()\" class=\"btn \"\r\n                                                style=\"padding: 0; border: none;background: transparent;\">\r\n                                                <img style=\"width:24px;height: 24px; \"\r\n                                                    src=\"../../../../../assets/images/icons/excel1.png\" />\r\n                                                &nbsp;Exportar\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div [style.display]=\"showData ? 'block' : 'none'\" class=\"row\" style=\"overflow: auto !important;\">\r\n                <div class=\"form-group\">\r\n                    <div class=\"col-md-12\">\r\n                        <div class=\"table-responsive\" >\r\n                            <table class=\"table table-striped table-bordered\"\r\n                                style=\"table-layout: fixed;\">\r\n                                <thead>\r\n                                    <tr>\r\n                                        <th style=\"text-align: center; width: 200px !important;\">Avances (S/.)\r\n                                        </th>\r\n                                        <th *ngFor=\"let item of arrayNumberWeek; let i = index\"\r\n                                            style=\"text-align: center; width: 80px !important;\"\r\n                                            class=\"hasTooltip\">\r\n                                            S{{i+1}}\r\n                                            <span>Fecha Inicio: {{listSemanasStart[i] | date: 'dd/MM/yyyy'}}</span>\r\n                                          </th>\r\n                                          \r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    <tr>\r\n                                      <th style=\"text-align: center; width: 200px !important;\" class=\"hasTooltip2\">\r\n                                        Costo Planificado\r\n                                        <span>Hrs Estimadas * Costo/Hora Estimado</span>\r\n                                      </th>\r\n                                        <th *ngFor=\"let item of listhoras; let i = index\"\r\n                                        style=\"text-align: center; width: 200px !important;\">   \r\n                                          {{listCostoPlanificado[i]}}                                                                                      \r\n                                        </th>\r\n                                    </tr>\r\n                                    <tr>\r\n                                      <th style=\"text-align: center; width: 200px !important;\" class=\"hasTooltip2\">\r\n                                        Costo Real\r\n                                        <span>Hrs Registradas * Costo/Hora Real</span>\r\n                                      </th>\r\n                                        <th *ngFor=\"let item of listhoras; let i = index\"\r\n                                        style=\"text-align: center; width: 200px !important;\">   \r\n                                          {{listCostoReal[i]}}                                                                                      \r\n                                        </th>\r\n                                    </tr>\r\n                                    <tr>\r\n                                        <th style=\"text-align: center; width: 200px !important;\">\r\n                                            Diferencia\r\n                                        </th>\r\n                                        <th *ngFor=\"let item of arrayNumberWeek; let e = index\"\r\n                                        style=\"text-align: center; width: 200px !important;\">\r\n                                            {{indicadorSemaforoNumber(e)}}  \r\n                                        </th>\r\n                                    </tr>   \r\n    \r\n                                    <tr>\r\n                                        <th style=\"text-align: center; width: 200px !important;\">Indicador Semáforo</th>\r\n                                            <th *ngFor=\"let item of arrayNumberWeek; let e = index\">\r\n                                            <div class=\"form-group text-left\">\r\n                                                <div class=\"circulooo\" [ngStyle]=\"{ 'background-color' : indicadorSemaforo(e)}\" style=\"margin: auto;\">\r\n                                                </div>\r\n                                            </div>\r\n                                        </th>\r\n                                    </tr>                  \r\n                                </tbody>\r\n                            </table>\r\n                            \r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <br>\r\n                <div class=\"form-group\">\r\n                    <div class=\"col-md-12\">\r\n                        <div class=\"table-responsive\" >\r\n                            <table class=\"table table-striped table-bordered\"\r\n                                style=\"table-layout: fixed;\">\r\n                                <thead>\r\n                                    <tr>\r\n                                        <th style=\"text-align: center; width: 200px !important;\">Avances (Horas)\r\n                                        </th>\r\n                                        <th *ngFor=\"let item of arrayNumberWeek; let i = index\"\r\n                                            style=\"text-align: center; width: 80px !important;\"\r\n                                            class=\"hasTooltip\">\r\n                                            S{{i+1}}\r\n                                            <span>Fecha Inicio: {{listSemanasStart[i] | date: 'dd/MM/yyyy'}}</span>\r\n                                          </th>\r\n                                          \r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    <tr>\r\n                                        <td [attr.colspan]=\"(arrayNumberWeek.length + 1)\" style=\"text-align: center;\">PLANIFICADO</td>\r\n                                    </tr>\r\n                                    <tr *ngFor=\"let item of listProjectEstimate; let i = index\">\r\n                                        <td style=\"text-align: center;\"> {{item.sperson}} ( {{item.srol}} ) </td>\r\n                                        <td *ngFor=\"let item of FilterPersonWeek(item.nid_person); let i = index\"  style=\"text-align: center;\">\r\n                                            {{item.nhours_asigned}}\r\n                                        </td>\r\n                                    </tr>           \r\n                                    <td [attr.colspan]=\"(arrayNumberWeek.length + 1)\" style=\"text-align: center;\">REAL</td>\r\n                                    <tr *ngFor=\"let item of personHours; let i = index\">\r\n                                        <td style=\"text-align: center;\"> {{item[2]}} </td>\r\n                                        <td *ngFor=\"let item2 of item[1]; let i = index\"  style=\"text-align: center;\">\r\n                                            {{item2}}\r\n                                        </td>\r\n                                    </tr>    \r\n                                </tbody>\r\n                            </table>\r\n                            \r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <br>\r\n                <div class=\"col-lg-12\">\r\n                    <div style=\"height: 500px;\">\r\n                      <canvas id=\"barchart1\">\r\n                      </canvas>\r\n                    </div>\r\n                </div>   \r\n                <br>  \r\n                <div class=\"col-lg-12\">\r\n                    <div style=\"height: 500px;\">\r\n                        <canvas id=\"chartCanvas\"></canvas>\r\n                    </div>\r\n                    <br>\r\n\r\n                    <div class=\"table-responsive\" style=\"padding: 30px;\">\r\n                        <table class=\"table table-striped table-bordered\"\r\n                            style=\"table-layout: fixed;\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th scope=\"col\" style=\"text-align: center\">\r\n                                        Total Tareas\r\n                                    </th>\r\n                                    <th scope=\"col\" style=\"text-align: center\">\r\n                                        Tareas Terminadas\r\n                                    </th>\r\n                                    <th scope=\"col\" style=\"text-align: center\">\r\n                                        Tareas en Tiempo\r\n                                    </th>\r\n                                    <th scope=\"col\" style=\"text-align: center\">\r\n                                        Tareas Fuera de Tiempo\r\n                                    </th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                <td style=\"text-align: center\">{{cumplimiento_totalTareas}}</td>\r\n                                <td style=\"text-align: center\">{{cumplimiento_tareasTerminadas}}</td>\r\n                                <td style=\"text-align: center\">{{cumplimiento_tareasATiempo}}</td>\r\n                                <td style=\"text-align: center\">{{cumplimiento_tareasFueraDeTiempo}}</td>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n\r\n                </div>    \r\n                <br>\r\n                 <div class=\"col-lg-12\">\r\n                    <div style=\"height: 500px;\">\r\n                        <canvas id=\"ganttChart\"></canvas>\r\n                    </div>\r\n                 </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<ngx-spinner name=\"SpinnerProject\" bdColor=\"rgba(51,51,51,0.8)\" size=\"large\" color=\"#fff\" type=\"ball-spin-clockwise\"\r\n    [fullScreen]=\"true\">\r\n    <p style=\"color: white\">Please Wait. </p>\r\n</ngx-spinner>"]},"metadata":{},"sourceType":"module"}